<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>TeamItaly 2025 Quals - VibeChallenge &#183; simonedimaria's blog</title><meta name=title content="TeamItaly 2025 Quals - VibeChallenge &#183; simonedimaria's blog"><meta name=description content='Writeup for the TeamItaly 2025 Quals web challenge "VibeChallenge".'><meta name=keywords content="client-side,cache-deception,apache,php,"><link rel=canonical href=https://simonedimaria.xyz/posts/teamitaly-quals-2025/vibechallenge/><meta name=author content="simonedimaria"><link href=https://x.com/dimariasimone rel=me><link href=https://github.com/simonedimaria rel=me><meta property="og:url" content="https://simonedimaria.xyz/posts/teamitaly-quals-2025/vibechallenge/"><meta property="og:site_name" content="simonedimaria's blog"><meta property="og:title" content="TeamItaly 2025 Quals - VibeChallenge"><meta property="og:description" content="Writeup for the TeamItaly 2025 Quals web challenge ‚ÄúVibeChallenge‚Äù."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-10T00:00:01+01:00"><meta property="article:modified_time" content="2025-06-10T00:00:01+01:00"><meta property="article:tag" content="Client-Side"><meta property="article:tag" content="Cache-Deception"><meta property="article:tag" content="Apache"><meta property="article:tag" content="Php"><meta property="og:image" content="https://simonedimaria.xyz/posts/teamitaly-quals-2025/vibechallenge/featured_vibechallenge.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonedimaria.xyz/posts/teamitaly-quals-2025/vibechallenge/featured_vibechallenge.png"><meta name=twitter:title content="TeamItaly 2025 Quals - VibeChallenge"><meta name=twitter:description content="Writeup for the TeamItaly 2025 Quals web challenge ‚ÄúVibeChallenge‚Äù."><link type=text/css rel=stylesheet href=/css/main.bundle.min.d1c3ed04af9c541a143b91860ca6fe24666aa88d10aab65acc4461f6cc04374f8fa72657c9d54c6dacd0c614e8a05f7b566106bfc06b5a75f9b8f888e083a834.css integrity="sha512-0cPtBK+cVBoUO5GGDKb+JGZqqI0QqrZazERh9swEN0+PpyZXydVMbazQxhTooF97VmEGv8BrWnX5uPiI4IOoNA=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js integrity="sha512-vdp97ObLrwje730lT3+ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"TeamItaly 2025 Quals - VibeChallenge","headline":"TeamItaly 2025 Quals - VibeChallenge","inLanguage":"en","url":"https://simonedimaria.xyz/posts/teamitaly-quals-2025/vibechallenge/","author":{"@type":"Person","name":"simonedimaria"},"copyrightYear":"2025","dateCreated":"2025-06-10T00:00:01\u002b01:00","datePublished":"2025-06-10T00:00:01\u002b01:00","dateModified":"2025-06-10T00:00:01\u002b01:00","keywords":["client-side","cache-deception","apache","php"],"mainEntityOfPage":"true","wordCount":"3213"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl backdrop-saturate-220 backdrop-brightness-112 dark:backdrop-saturate-180 dark:backdrop-brightness-95 bg-primary-200/80 bg-linear-60 dark:bg-primary-800/30 shadow-xl"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">simonedimaria&rsquo;s blog</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Blog title=Blog><span class="text-base font-medium break-normal">Blog
</span></a><a href=/tags/ class="flex items-center bf-icon-color-hover" aria-label=Tags title=Tags><span class="text-base font-medium break-normal">Tags
</span></a><a href=https://x.com/dimariasimone target=_blank class="flex items-center bf-icon-color-hover" aria-label=x-twitter title><span><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</span></a><a href=https://github.com/simonedimaria target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a href class="flex items-center bf-icon-color-hover" title></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Blog class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Blog class="text-2xl font-bold tracking-tight">Blog</span></a></div><div class=px-2><a href=/tags/ aria-label=Tags class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Tags class="text-2xl font-bold tracking-tight">Tags</span></a></div><div class=px-2><a href=https://x.com/dimariasimone aria-label=x-twitter target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</span><span title class="text-2xl font-bold tracking-tight"></span></a></div><div class=px-2><a href=https://github.com/simonedimaria aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div><div class=px-2><a href class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title class="text-2xl font-bold tracking-tight"></span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><figure><img src=/posts/teamitaly-quals-2025/vibechallenge/background_vibechallenge_hu_a78a10c2c4f69624.png alt="TeamItaly 2025 Quals - VibeChallenge" loading=eager decoding=async fetchpriority=high class="w-full rounded-lg single_hero_round nozoom"></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/></a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Blog</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/teamitaly-quals-2025/vibechallenge/>TeamItaly 2025 Quals - VibeChallenge</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">TeamItaly 2025 Quals - VibeChallenge</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-06-10T00:00:01+01:00>10 June 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3213 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">16 mins</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/categories/web/","_self"),!1'><span class=flex style=cursor:pointer><span class="bg-blue-700 rounded-full border-2 border-neutral-200 px-3 py-1 text-sm font-normal text-neutral-200 dark:border-neutral-400 dark:text-neutral-200">üåê Web
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/client-side/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Client-Side
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/cache-deception/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cache-Deception
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/apache/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Apache
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/php/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Php</span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=simonedimaria src=/img/gatto-stregone-ciccione_hu_188236a87140fe13.jpeg data-zoom-src=/img/gatto-stregone-ciccione_hu_fb492fc6455199ab.jpeg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">simonedimaria</div><div class="text-sm text-neutral-700 dark:text-neutral-400"><em>I make a bunch of electrons dance on some rock to hack stuff</em></div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/dimariasimone target=_blank aria-label=X-Twitter title=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/simonedimaria target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#challenge-scenario>Challenge scenario</a></li><li><a href=#solution>Solution</a><ul><li><a href=#rfc-3875-and-local-redirects>RFC 3875 and Local Redirects</a></li><li><a href=#schr√∂dinger-cookies>&ldquo;Schr√∂dinger cookies&rdquo;</a></li><li><a href=#rfc-6265-and-cookie-sorting-to-shadow-bot-session>RFC 6265 and cookie sorting to shadow bot session</a></li><li><a href=#forcing-cookie-deletion-with-crlf-injection>Forcing cookie deletion with CRLF injection</a></li></ul></li><li><a href=#exploitation>Exploitation</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#challenge-scenario>Challenge scenario</a></li><li><a href=#solution>Solution</a><ul><li><a href=#rfc-3875-and-local-redirects>RFC 3875 and Local Redirects</a></li><li><a href=#schr√∂dinger-cookies>&ldquo;Schr√∂dinger cookies&rdquo;</a></li><li><a href=#rfc-6265-and-cookie-sorting-to-shadow-bot-session>RFC 6265 and cookie sorting to shadow bot session</a></li><li><a href=#forcing-cookie-deletion-with-crlf-injection>Forcing cookie deletion with CRLF injection</a></li></ul></li><li><a href=#exploitation>Exploitation</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">TeamItaly 2025 Quals - VibeChallenge<div id=teamitaly-2025-quals---vibechallenge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#teamitaly-2025-quals---vibechallenge aria-label=Anchor>#</a></span></h1><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=tip><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 384 512"><path fill="currentColor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438.0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1H112L112.1 454.3zM191.4.0132C89.44.3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8 16.53 18.84 42.34 58.23 52.22 91.45.0313.25.0938.5166.125.7823h160.2c.0313-.2656.0938-.5166.125-.7823 9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1 368 78.61 288.9-.2837 191.4.0132zM192 96.01c-44.13.0-80 35.89-80 79.1.0 9.69-7.2 16.89-16 16.89S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1 8.844.0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg></span></div><div class=grow>Tip</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>First blooding this challenge put me in first place for the web players selection for the official TeamItaly 2025 qualification event! :)</p></div></div><h2 class="relative group">Description<div id=description class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#description aria-label=Anchor>#</a></span></h2><blockquote><p>A web challenge built on instinct, caffeine, and zero planning. Everything kind of works ‚Äî and that‚Äôs good enough. Follow the vibes. Something might happen.</p></blockquote><h2 class="relative group">Challenge scenario<div id=challenge-scenario class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#challenge-scenario aria-label=Anchor>#</a></span></h2><p>The challenge is a php webapp on php-cgi served with Apache. The php service then sits behind an nginx reverse proxy, with the following configurations</p><p><strong>nginx.conf</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>user</span> <span class=s>nginx</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>worker_processes</span> <span class=s>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>events</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>worker_connections</span> <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_cache_path</span> <span class=s>/var/cache/nginx</span> <span class=s>levels=1:2</span> <span class=s>keys_zone=STATIC:100m</span> <span class=s>inactive=60m</span> <span class=s>use_temp_path=off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>include</span> <span class=s>/etc/nginx/mime.types</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>default_type</span> <span class=s>application/octet-stream</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>sendfile</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>keepalive_timeout</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>include</span> <span class=s>/etc/nginx/conf.d/*.conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p><strong>default.conf</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>add_header</span> <span class=s>Content-Security-Policy</span> <span class=s>&#34;default-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span><span class=kn>&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>add_header</span> <span class=s>X-Content-Type-Options</span> <span class=s>nosniff</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>set</span> <span class=nv>$proxy_host</span> <span class=nv>${BACKEND_HOST}</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_pass</span> <span class=s>http://</span><span class=nv>$proxy_host:80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>Host</span> <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/cgi-bin/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>deny</span> <span class=s>all</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=p>~</span> <span class=sr>^/image.php$</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>deny</span> <span class=s>all</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/static/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_pass</span> <span class=s>http://</span><span class=nv>${BACKEND_HOST}:80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache</span> <span class=s>STATIC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_valid</span> <span class=mi>200</span> <span class=mi>302</span> <span class=mi>10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_valid</span> <span class=mi>404</span>      <span class=mi>1m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_key</span> <span class=s>&#34;</span><span class=nv>$scheme$proxy_host$request_uri&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>add_header</span> <span class=s>X-Proxy-Cache</span> <span class=nv>$upstream_cache_status</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=kn>proxy_ignore_headers</span> <span class=s>Set-Cookie</span> <span class=s>Cache-Control</span> <span class=s>Expires</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=p>~</span> <span class=sr>&#34;^\/image\/([a-fA-F0-9]</span><span class=p>{</span><span class=kn>8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12})&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>rewrite</span> <span class=s>&#34;^\/image\/(?&lt;uuid&gt;[a-f0-9]</span><span class=p>{</span><span class=kn>8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12})$&#34;</span> <span class=s>/image.php?id=</span><span class=nv>$uuid</span> <span class=s>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_pass</span> <span class=s>http://</span><span class=nv>${BACKEND_HOST}:80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache</span> <span class=s>STATIC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_valid</span> <span class=mi>200</span> <span class=mi>302</span> <span class=mi>5m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_valid</span> <span class=mi>404</span>      <span class=mi>1m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_cache_key</span> <span class=s>&#34;</span><span class=nv>$scheme$proxy_host$request_uri&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>add_header</span> <span class=s>X-Proxy-Cache</span> <span class=nv>$upstream_cache_status</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=kn>proxy_hide_header</span> <span class=s>Set-Cookie</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_ignore_headers</span> <span class=s>Set-Cookie</span> <span class=s>Cache-Control</span> <span class=s>Expires</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>The nginx configuration has a cache zone setup for <code>/static/</code> and <code>/image/</code> paths under <code>/var/cache/nginx</code> with no per-user distinction because of the cache key being constructed only with <code>$scheme</code>, <code>$proxy_host</code> and <code>$request_uri</code> variables.</p><p>Regarding the php webapp, we can register as a user, update our bio, upload images and report an url to the bot.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="challenge overview" src=./img/vibechallenge_overview.png></figure></p><p>The code responsible for the <code>/register.php</code> endpoint is the following:</p><p><strong>register.php</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>include</span> <span class=s1>&#39;utils.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s2>&#34;REQUEST_METHOD&#34;</span><span class=p>]</span> <span class=o>===</span> <span class=s2>&#34;POST&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$username</span> <span class=o>=</span> <span class=nx>trim</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s2>&#34;username&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$username</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>start_session</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$username</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>redirect</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=nx>setcookie</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>Upon providing a username with a POST request, a session is created with the <code>start_session()</code> utility function:</p><p><strong>utils.php</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>function</span> <span class=nf>start_session</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$hardening_options</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;lifetime&#39;</span> <span class=o>=&gt;</span> <span class=mi>6000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;path&#39;</span> <span class=o>=&gt;</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;ORIG_PATH_INFO&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;domain&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;HTTP_HOST&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;httponly&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_set_cookie_params</span><span class=p>(</span><span class=nv>$hardening_options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>Interestingly, if the <code>next</code> cookie is present at the time of registration, its value will be used as redirect path target, otherwise the user will simply be redirected to the homepage.</p><p>The bio functionality is just:</p><p><strong>update_bio.php</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>include</span> <span class=s1>&#39;utils.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>include</span> <span class=s1>&#39;is_logged.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$user</span> <span class=o>=</span> <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;bio&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$bio</span> <span class=o>=</span> <span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;bio&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;bio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$bio</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/bio.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>Since the bio content is sanitized with <code>htmlspecialchars</code> there&rsquo;s no free XSS for us :(</p><p>The image upload functionality is pretty much just boilerplate, so I&rsquo;ll skip it. Just something to know is that the <code>/upload_image.php</code> will handle the form submission and save the image in the db with an UUID filename (so no html injection or header injection within the filename). Then the same image can be viewed via the <code>/image/&lt;uuid></code> endpoint, where nginx will take the UUID from the path and rewrite it to <code>/image.php?id=&lt;uuid></code>.</p><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=note><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg></span></div><div class=grow>Note</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>The UUID parameter passed in <code>/image</code> is validated by nginx with the provided regex, moreover direct access to <code>/image.php</code> is denied by nginx, but if that would have been of our interest we could have kinda bypassed it by clobbering the <code>?id</code> parameter in the nginx rewrite. In the screenshot below I upload the <code>babelo.png</code> image that gives me the <code>7ab2...</code> uuid, and the <code>floridamanspankinghimself.png</code> image that gives me the <code>90aa...</code> uuid, then I access the <code>/image/7ab2...?id=90aa...</code> endpoint and the second image is served instead of the first one. In the apache logs i logged the full request URI in <code>image.php</code> and it shows the clobbering. I could&rsquo;ve also used whatever value as the <code>id</code> parameter because the validation happens only on the nginx side.</p></div></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="clobbering the id parameter" src=./img/clobbering_id_parameter.png></figure></p><p>But anyway that&rsquo;s just useless in this challenge scenario.</p><p>Note that what all these endpoints (<code>upload_image.php</code>, <code>image.php</code>, <code>update_bio.php</code>, <code>bio.php</code>) have in common is the <code>include 'is_logged.php'</code> at top of the script, so it&rsquo;s definitely worth taking a look:</p><p><strong>is_logged.php</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>start_session</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Check if the user is logged. If not redirect to the registration page.*/</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setcookie</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>,</span>  <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;ORIG_PATH_INFO&#39;</span><span class=p>],</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/register.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* if newly logged redirect to next url */</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirect</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setcookie</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>This snippet firstly starts a new session or resumes the current one by checking the given (if any) <code>PHPSESSID</code> cookie, checks if the user have an active session, if not it sets the <code>next</code> cookie with the current path and redirects to <code>/register.php</code>. If the user is logged in instead, and the <code>next</code> cookie is present, it redirects to that path.<br>It sounds like a promising client side gadget, but that&rsquo;s just not enough to solve the challenge.<br>As common for client side challenges, the actions the bot does, is a crucial part of the challenge, so let&rsquo;s shift the focus to it.</p><p><strong>bot.php</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$url</span> <span class=o>=</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>str_starts_with</span><span class=p>(</span><span class=nv>$url</span><span class=p>,</span> <span class=s2>&#34;http://&#34;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>str_starts_with</span><span class=p>(</span><span class=nv>$url</span><span class=p>,</span> <span class=s2>&#34;https://&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Url is not valid&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$actions</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;browser&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;chrome&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;timeout&#39;</span> <span class=o>=&gt;</span> <span class=mi>120</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;actions&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;request&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;url&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timeout&#39;</span> <span class=o>=&gt;</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sleep&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;time&#39;</span> <span class=o>=&gt;</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Register the account
</span></span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;request&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;url&#39;</span> <span class=o>=&gt;</span> <span class=nv>$CHALLENGE_URL</span> <span class=o>.</span> <span class=s1>&#39;/register.php&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timeout&#39;</span> <span class=o>=&gt;</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;type&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;element&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;input#username&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;value&#39;</span> <span class=o>=&gt;</span> <span class=nv>$username</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;click&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;element&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;button#submit&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sleep&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;time&#39;</span> <span class=o>=&gt;</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Insert the flag
</span></span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;request&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;url&#39;</span> <span class=o>=&gt;</span> <span class=nv>$CHALLENGE_URL</span> <span class=o>.</span> <span class=s1>&#39;/update_bio.php&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timeout&#39;</span> <span class=o>=&gt;</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;type&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;element&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;textarea#bio&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;value&#39;</span> <span class=o>=&gt;</span> <span class=nv>$FLAG</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;click&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;element&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;button#submit&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sleep&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;time&#39;</span> <span class=o>=&gt;</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span></span></span></code></pre></div></div><p>We can only report HTTP(s) urls, but no origin check is made, meaning we can make the bot visit a controlled page.<br>Then, the bot will do the following:</p><ol><li>Visit the provided URL</li><li>sleep 10s</li><li>Register a new user with a random username</li><li>sleep 5s</li><li>Update the user bio with the flag</li><li>sleep 10s</li></ol><p>For anyone with a bit of client side challenge experience knows that it&rsquo;s not too common to have the bot visit our controlled page before putting flag or any actions in general, therefore it can be an hint of what to search for.</p><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=note><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg></span></div><div class=grow>Note</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>A first idea was some sort of <a href="https://owasp.org/www-community/attacks/Session_fixation#:~:text=The%20attack%20consists%20of%20obtaining%20a%20valid%20session%20ID%20%28e.g.%20by%20connecting%20to%20the%20application%29%2C%20inducing%20a%20user%20to%20authenticate%20himself%20with%20that%20session%20ID%2C%20and%20then%20hijacking%20the%20user-validated%20session%20by%20the%20knowledge%20of%20the%20used%20session%20ID." target=_blank rel=noreferrer>session fixation</a>, by forcing the bot to login with a user we know, and write the flag to the bio of that user, and finally retrieving it later. Clearly, such attack is not trivially possible on modern browsers, but some CSRF-vulnerable applications could allow it.
While looking for such possibility in PHP I found the <a href=https://www.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid target=_blank rel=noreferrer><code>session.use_trans_sid</code></a> option, which <a href="https://www.php.net/manual/en/session.idpassing.php#:~:text=PHP%20is%20capable%20of%20transforming%20links%20transparently.%20If%20the%20run-time%20option%20session.use_trans_sid%20is%20enabled%2C%20relative%20URIs%20will%20be%20changed%20to%20contain%20the%20session%20id%20automatically.%20" target=_blank rel=noreferrer>allows to pass the PHPSESSID via as URL param</a>. However, this option is disabled by default and indeed the PHP documentation also states the security risks around it.</p></div></div><p>Apart from that, no particular user interaction is made, so we have to invent something with what we have.</p><h2 class="relative group">Solution<div id=solution class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#solution aria-label=Anchor>#</a></span></h2><p>Since we can send the bot to an arbitrary HTTP(S) url, we can take advantage of the <code>next</code> cookie behaviour to possibily redirect the bot to any endpoint, we also know that some caching is being used for the <code>/image/</code> where we can also upload an image, and that the bot will visit our controlled page before writing the flag to the bio.<br>Given that the <code>/image/&lt;uuid></code> route is rewritten to <code>/image.php?id=&lt;uuid></code> and that in <code>image.php</code> the <code>is_logged.php</code> is included, we can maybe leverage the <code>next</code> cookie to force a redirect in <code>image.php</code> to the <code>/bio.php</code> page and therefore cache the response (including the flag) under a <code>/image/&lt;uuid></code> path?</p><h3 class="relative group">RFC 3875 and Local Redirects<div id=rfc-3875-and-local-redirects class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#rfc-3875-and-local-redirects aria-label=Anchor>#</a></span></h3><p>&ldquo;<em>But won&rsquo;t nginx just cache the 302 redirect and let that redirect happen on the client side?</em>&rdquo;<br>It makes sense, but that&rsquo;s not the case in Apache for CGI scripts, that is correctly following <strong>RFC 3875</strong>. Taken from <a href=https://blog.orange.tw/posts/2024-08-confusion-attacks-en/ target=_blank rel=noreferrer>Orange Tsai &ldquo;Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!&rdquo; research</a>: RFC 3875 is a specification about CGI, and Section 6.2.2 defines a &ldquo;Local Redirect Response&rdquo; behavior:</p><blockquote><p>[&mldr;] The CGI script can return a URI path and query-string (‚Äòlocal-pathquery‚Äô) for a local resource in a Location header field. This indicates to the server that it should reprocess the request using the path specified.</p></blockquote><p><strong>The specification mandates that under certain conditions, CGI must use Server-Side resources to handle redirects</strong>. In other words, Apache internally follows 302 redirects on CGI scripts responses when the <code>Location</code> header is present with a path that begins with <code>/</code>, and therefore nginx will see the final response from Apache, which is the <code>/bio.php</code> page and cache it under the <code>/image/&lt;uuid></code> path.</p><p>Nice, sounds good. Where do we start then?<br>First of all, our goal is to have the bot visit the <code>/image/&lt;uuid></code> endpoint with a <code>next</code> cookie set to <code>/bio.php</code>, and in order to make it have effect, we want to hit the else branch of the <code>is_logged.php</code> snippet, with a valid session, and make the bot redirect.</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=cm>/* Check if the user is logged. If not redirect to the registration page.*/</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setcookie</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>,</span>  <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;ORIG_PATH_INFO&#39;</span><span class=p>],</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/register.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cm>/* if newly logged redirect to next url */</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirect</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;next&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setcookie</span><span class=p>(</span><span class=s1>&#39;next&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>We know that Apache will follow that local redirect and so the final cached page by nginx will be the <code>/bio.php</code> page with the flag it just put.</p><h3 class="relative group">&ldquo;Schr√∂dinger cookies&rdquo;<div id=schr√∂dinger-cookies class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#schr%c3%b6dinger-cookies aria-label=Anchor>#</a></span></h3><p>But, how can we have an active session to reach the cachable page via redirect, but at the same time don&rsquo;t have an active session to set the <code>next</code> cookie? If we look into the <code>start_session()</code> function again, we note one fundamental detail:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>function</span> <span class=nf>start_session</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$hardening_options</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;lifetime&#39;</span> <span class=o>=&gt;</span> <span class=mi>6000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;path&#39;</span> <span class=o>=&gt;</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;ORIG_PATH_INFO&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;domain&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;HTTP_HOST&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;httponly&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_set_cookie_params</span><span class=p>(</span><span class=nv>$hardening_options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>The session cookie is set with the <code>path</code> option to <code>dirname(ORIG_PATH_INFO)</code> which is basically just the cgi script name we&rsquo;re hitting. E.g. if we request the <code>/bio.php/whatever</code> resource, <code>ORIG_PATH_INFO</code> will be set to <code>/bio.php/whatever</code>, and <code>dirname("/bio.php/whatever")</code> will be <code>/bio.php</code>, meaning that the session cookie will be scoped to the <code>/bio.php</code> path.</p><p>Ok, so we just make the unauthenticated bot visit the <code>/bio.php</code> endpoint so that the <code>next</code> cookie will be set to <code>/bio.php</code>, and then make the bot visit <code>/image/&lt;uuid></code> after login to cache the flag with the redirection?</p><p>Yes, but we have a few issues with that:</p><ol><li>if we set <code>next=/bio.php</code> before the bot registers, the <code>next</code> cookie will be immediately consumed just after the register form submission because of the else branch in <code>is_logged.php</code>.</li><li>we can&rsquo;t set <code>next=/bio.php</code> after the bot registered and put the flag in the bio, because at that point a session will be already active and no <code>next</code> cookie will be created. Also, the flag is stored inside the session, so we can&rsquo;t just somehow make the session die and then cache the flag.</li></ol><p>At this point, we come to the conclusion that we need a sort of <strong>&ldquo;Schr√∂dinger cookie&rdquo; state</strong>: keep the bot logged in enough to write the flag, but preserve a <code>next</code> value that will later force <code>/image/&lt;uuid></code> to answer with a redirect to <code>/bio.php</code>.</p><center><img src=./img/schrodinger_cookie.png width=500 alt="Schr√∂dinger Cookie"></center><p>This was kinda confusing to me in the first place, and honestly I didn&rsquo;t understood everything that was going on at the time of solving this challenge. A lot of assumptions were made based on experience and trial & error. There was not much room for overthinking.<br>In fact, by playing a bit with some edge case scenarios I found that creating two sessions (<code>path=/</code> and <code>path=/bio.php</code>), caused some confusion and somehow I was able to pass on the <code>/image/&lt;uuid></code> unauthenticated and getting the 302 redirect with the flag in the cache of my uploaded image path, but I didn&rsquo;t really fully understood how that happened in that moment.</p><h3 class="relative group">RFC 6265 and cookie sorting to shadow bot session<div id=rfc-6265-and-cookie-sorting-to-shadow-bot-session class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#rfc-6265-and-cookie-sorting-to-shadow-bot-session aria-label=Anchor>#</a></span></h3><p>So, how was that possible? At CTF ended I looked into it and found plausible explanations:</p><ul><li>Both <code>PHPSESSID</code> cookies are stored by Chrome.</li><li>In accordance to <a href=https://datatracker.ietf.org/doc/html/rfc6265#section-5.4 target=_blank rel=noreferrer>RFC 6265 ¬ß5.4(2)</a>, User Agents should sort cookies if multiple are present in the <code>Cookie</code> header. That <strong>sorting is firstly prioritizing <code>path</code> length</strong>. Yes, the value length, not &ldquo;the most nested path&rdquo; nor &ldquo;the stricter scope&rdquo; or any other semantic measure.</li></ul><blockquote><p>[&mldr;]
2. The user agent SHOULD sort the cookie-list in the following order:</p><ul><li>Cookies with longer paths are listed before cookies with shorter paths.</li></ul></blockquote><p>So, given two <code>PHPSESSID</code> cookies with <code>path=/aaa.php</code> and <code>path=/bbbb.php</code>, the second one will be prioritized in the sorting. Same goes for <code>path=/a/a.php</code> vs <code>path=/bbbb.php</code>. And, obviously, in our case <code>path=/bio.php</code> will be prioritized over <code>path=/</code>.<br>Moreover:</p><ul><li>Multiple cookies being sorted in the <code>Cookie</code> header by Chrome doesn&rsquo;t necessarly means that the first one will be prioritized when processed by the HTTP server. However, that is the case for PHP, as <strong>it does take the first occurrence in the header</strong>.</li><li>Being the cookie with scope <code>path=/bio.php</code> the selected one for the session, PHP will consider it not valid for any navigation outside <code>/bio.php</code> and therefore the <code>/image/&lt;uuid></code> request with the two cookies will effectively being considered as an unauthenticated request on that route. No, PHP does not fallback on the second cookie because the <code>$_COOKIE</code> superglobal exposes only one entry per name. The <code>path=/</code> cookie is effectively useless because it&rsquo;ll always being ignored while the <code>path=/bio.php</code> cookie exists in the browser.</li></ul><p>This is useful for us, because it allows us to have a session state in the browser that is effectively &ldquo;authenticated&rdquo; only for the <code>/bio.php</code> path, exactly the &ldquo;Schr√∂dinger cookie&rdquo; we needed.<br>At this point, we only need to make the bot reach the <code>/image/&lt;uuid></code> endpoint with the <code>next=/bio.php</code> cookie set, so that a 302 redirect (that, again, is internally followed by Apache) to the authenticated view of <code>/bio.php</code> is cached by nginx under the <code>/image/&lt;uuid></code> path. <strong>This is Cache Deception and allows us to retrieve the flag later on from the cache</strong>.</p><p>However, we can&rsquo;t just set and forget the <code>next=/bio.php</code> cookie, because of the first issue we mentioned: if we set it before registration, it&rsquo;ll be consumed immediately after the form submission and the bot will never be able to write and submit the flag in the <code>update_bio.php</code> form.<br>So, how the hell can we have the <code>next=/bio.php</code> cookie set, but not consumed at registration time?</p><h3 class="relative group">Forcing cookie deletion with CRLF injection<div id=forcing-cookie-deletion-with-crlf-injection class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#forcing-cookie-deletion-with-crlf-injection aria-label=Anchor>#</a></span></h3><p>I found a pretty neat trick by <strong>injecting CRLF in the <code>next</code> cookie value</strong>: If we set <code>next</code> to something like <code>/bio.php/%0d%0aXXX</code>, then when PHP later executes <code>header('Location: ' . $_COOKIE['next'])</code>, it detects the newline and refuses that <code>Location</code> header with a <code>Warning: Header may not contain more than a single header, new line detected in /var/www/html/utils.php on line 10</code> warning. See <a href=https://github.com/php/php-src/blob/master/main/SAPI.c#L757-L767 target=_blank rel=noreferrer>PHP source code</a>.<br>This allows us to both probe the <code>/bio.php</code> path to create the <code>path=/bio.php</code> session cookie before registration, let the bot register and so it creates the <code>path=/</code> session cookie too, AND don&rsquo;t have an annoying <code>next</code> cookie so that the bot can later write the flag in the bio:</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="Two active sessions with different scopes" src=./img/crlf_inj_warning.png></figure></p><p>When the bot sets the flag from the <code>/update_bio.php</code> page later on, the <code>next</code> cookie will not be present, so the form will successfully redirect to <code>/bio.php</code>, and since the <code>path=/bio.php</code> session cookie is valid for that path, the flag will be correctly stored in the session and shown in the bio page.<br>BUT, at this point, the <code>bio.php</code> page will also redirect to <code>register.php</code> (<code>update_bio.php (302) -> bio.php (302) -> register.php</code>)! WHY !?</p><p>Well, we talked about the two active session cookies as &ldquo;authenticated&rdquo; for their respective paths, but actually the <code>path=/bio.php</code> session cookie is not really &ldquo;authenticated&rdquo;, because the registration form submission saved user information only inside the <code>path=/</code> scoped session!<br>Let&rsquo;s have a look at the session of the previous image inside the container at <code>/var/lib/php/sessions/</code>:</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="empty session cookie" src=./img/php_sess_cookies.png></figure></p><p>As we can see, the <code>path=/bio.php</code> scoped session cookie (<code>sess_cc6c9e9t3fgdfpef1gav3u8epsh7</code>) <strong>is effectively empty</strong>. When the bot visits <code>/bio.php</code> with that cookie, the <code>is_logged.php</code> snippet will check for the presence of <code>$_SESSION['user']</code>, but since that session is empty, it will consider the bot as unauthenticated and therefore redirect to <code>register.php</code>, AND also set the <code>next=/bio.php</code> cookie!</p><p>That&rsquo;s actually perfect for us, because it allows to have the following final exploitable cookie state:</p><ul><li><code>PHPSESSID=cc6c9e9t3fgdfpef1gav3u8eps path=/bio.php</code> session cookie <strong>without</strong> user information, but containing the session-stored bio, i.e. the flag.</li><li><code>PHPSESSID=08k4s4fko6iurbcaijafijgm9e path=/</code> session cookie with authenticated user information, will be ignored in favour of the other one.</li><li><code>next=/bio.php</code> cookie set after the bio update form submission.</li></ul><p>Given this, just making the bot visit the <code>/image/&lt;uuid></code> endpoint will cause:</p><ol><li>only the <code>path=/bio.php</code> session cookie to be considered, which does not contain <code>$_SESSION['user']</code>, so the else branch of <code>is_logged.php</code> is executed, and the bot is redirected</li><li>the bot is redirected to <code>/bio.php</code> because of the <code>next</code> cookie</li><li>on the <code>/bio.php</code> page, the <code>path=/bio.php</code> session cookie is valid, so the flag is shown in the bio and not redirected again.</li><li>nginx caches this redirection flow under the <code>/image/&lt;uuid></code> path.</li></ol><p><strong>All that, caused by just making the bot visit a <code>/bio.php/%0d%0aX</code> endpoint before registration!</strong></p><p>&ldquo;<em>Umhhh, but if it will redirect to this path won&rsquo;t the server just give 404 and not match the <code>/bio.php</code> cgi script?</em>&rdquo;<br>Not with default apache settings for CGI scripts (<a href=https://httpd.apache.org/docs/2.4/mod/core.html target=_blank rel=noreferrer>taken from apache documentation</a>):</p><blockquote><p>The <a href=https://httpd.apache.org/docs/2.4/mod/core.html#AcceptPathInfo target=_blank rel=noreferrer><code>AcceptPathInfo</code></a> directive <em>controls whether requests that contain trailing pathname information that follows an actual filename (or non-existent file in an existing directory) will be accepted or rejected.</em>, and &mldr; <em>Handlers that serve scripts, such as cgi-script and isapi-handler, generally accept PATH_INFO by default</em>.</p></blockquote><p>In other words, the <code>/bio.php/whatever</code> request is handled by <code>bio.php</code> and gives us the path-scoped session behavior we need.</p><h2 class="relative group">Exploitation<div id=exploitation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#exploitation aria-label=Anchor>#</a></span></h2><p>Fantastic, we have everything in place. Putting everything together:</p><ol><li>We upload an image with the <code>/upload_image.php</code> endpoint, which will give us a <code>/image/&lt;uuid></code> endpoint to access the image. We DO NOT visit that endpoint yet to not infer the nginx cache.</li><li>We can send the bot to <code>/bio.php/%0d%0aX</code>, an empty session cookie scoped to <code>/bio.php</code> will be created, and also a <code>next=/bio.php/%0d%0aX</code> cookie.</li><li>We let the bot register. This action will create a new session cookie with user information + <code>path=/</code>, destroy the <code>next=/bio.php/%0d%0aX</code> too and return the warning.</li><li>We let the bot put the flag in his bio.</li><li>The update bio form submission will redirect to <code>/bio.php</code>, save the flag on the empty session, and then redirect to <code>register.php</code>. Will also set the <code>next=/bio.php</code> cookie.</li><li>Then we send the bot to <code>/image/&lt;uuid></code> from step 1). <code>is_logged.php</code> emits <code>Location: /bio.php</code>, Apache follows that internally, and nginx caches that response (status 302, body contains the flag page).</li><li>We access the same <code>/image/&lt;uuid></code> from our side and read the cached flag.</li></ol><p>The solve script is therefore as simple as:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>indicator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>search</span><span class=p>).</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;i&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>sleep</span> <span class=o>=</span> <span class=p>(</span><span class=nx>ms</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>ms</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>indicator</span> <span class=o>==</span> <span class=s2>&#34;setup&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s2>&#34;/?i=exploit&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>indicator</span> <span class=o>==</span> <span class=s2>&#34;exploit&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s2>&#34;http://nginx/bio.php/%0d%0aX&#34;</span><span class=p>);</span> <span class=c1>// do our lil trick before registration
</span></span></span><span class=line><span class=cl>        <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;/step1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>sleep</span><span class=p>(</span><span class=mi>42_000</span><span class=p>);</span> <span class=c1>// give time to the bot to register and update the bio with the flag
</span></span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s2>&#34;http://nginx/image/4ddee601-7e75-465f-bc1c-1f377e800595&#34;</span><span class=p>);</span> <span class=c1>// force the bot to cache the flag page on this endpoint
</span></span></span><span class=line><span class=cl>        <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;/step2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>})();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span></span></span></code></pre></div></div><p>We then submit the <code>http://xxxxx.requestrepo.com/?i=setup</code> url to the bot, and after the report we retrieve the flag at <code>/image/4ddee601-7e75-465f-bc1c-1f377e800595</code>:</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=flag src=./img/flag.png></figure></p><blockquote><p><code>TeamItaly{ch47gp7_54id_17_w45_f1n3_50_175_f1n3_cc4150dd0957c18f}</code></p></blockquote></div></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/teamitaly-quals-2025/taskrunner/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;TeamItaly 2025 Quals - TaskRunner
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-06-10T00:00:00+01:00>10 June 2025</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/ctrl+space-ctf-finals-2025/ricingstar/><span class=leading-6>Ctrl+Space CTF Finals 2025 - RicingStar [Author Writeup]&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-11-01T00:00:00+01:00>1 November 2025</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
simonedimaria</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://simonedimaria.xyz/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>