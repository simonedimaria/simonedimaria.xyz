<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>HTB Business CTF 2024 - MetaVault [Author Writeup] &#183; simonedimaria's blog</title><meta name=title content="HTB Business CTF 2024 - MetaVault [Author Writeup] &#183; simonedimaria's blog"><meta name=description content='Author writeup for the "MetaVault" easy blockchain challenge from HTB Business CTF 2024.'><meta name=keywords content="authored,metadata,IPFS,"><link rel=canonical href=https://simonedimaria.xyz/posts/htb-businessctf-2024/metavault/><meta name=author content="simonedimaria"><link href=https://x.com/dimariasimone rel=me><link href=https://github.com/simonedimaria rel=me><meta property="og:url" content="https://simonedimaria.xyz/posts/htb-businessctf-2024/metavault/"><meta property="og:site_name" content="simonedimaria's blog"><meta property="og:title" content="HTB Business CTF 2024 - MetaVault [Author Writeup]"><meta property="og:description" content="Author writeup for the â€œMetaVaultâ€ easy blockchain challenge from HTB Business CTF 2024."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-10T00:00:02+01:00"><meta property="article:modified_time" content="2024-05-10T00:00:02+01:00"><meta property="article:tag" content="Authored"><meta property="article:tag" content="Metadata"><meta property="article:tag" content="IPFS"><meta property="og:image" content="https://simonedimaria.xyz/posts/htb-businessctf-2024/metavault/featured_htb_bizctf_banner.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonedimaria.xyz/posts/htb-businessctf-2024/metavault/featured_htb_bizctf_banner.png"><meta name=twitter:title content="HTB Business CTF 2024 - MetaVault [Author Writeup]"><meta name=twitter:description content="Author writeup for the â€œMetaVaultâ€ easy blockchain challenge from HTB Business CTF 2024."><link type=text/css rel=stylesheet href=/css/main.bundle.min.952cc647d4f186c59ed07b5684e5ff442e04b033940e76cd8eba3a6c51251b07588d9c7b14636937cbde18a1ba69be3b8055148a0d1e2e6c17c46d564fb6ecbf.css integrity="sha512-lSzGR9TxhsWe0HtWhOX/RC4EsDOUDnbNjro6bFElGwdYjZx7FGNpN8veGKG6ab47gFUUig0eLmwXxG1WT7bsvw=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.c586c752b99483da1d0b024cb91220f5defda40000f3549b073a52dea6c99c78c50d376eb71e78969112c5dbc24bc4001182bd096c47d2e025053efd92d91b4c.js integrity="sha512-xYbHUrmUg9odCwJMuRIg9d79pAAA81SbBzpS3qbJnHjFDTdutx54lpESxdvCS8QAEYK9CWxH0uAlBT79ktkbTA==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"HTB Business CTF 2024 - MetaVault [Author Writeup]","headline":"HTB Business CTF 2024 - MetaVault [Author Writeup]","abstract":"Author writeup for the \u0026ldquo;MetaVault\u0026rdquo; easy blockchain challenge from HTB Business CTF 2024.","inLanguage":"en","url":"https:\/\/simonedimaria.xyz\/posts\/htb-businessctf-2024\/metavault\/","author":{"@type":"Person","name":"simonedimaria"},"copyrightYear":"2024","dateCreated":"2024-05-10T00:00:02\u002b01:00","datePublished":"2024-05-10T00:00:02\u002b01:00","dateModified":"2024-05-10T00:00:02\u002b01:00","keywords":["authored","metadata","IPFS"],"mainEntityOfPage":"true","wordCount":"1765"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">simonedimaria&rsquo;s blog</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Blog><p class="text-base font-medium">Blog</p></a><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-base font-medium">Tags</p></a><a href=https://x.com/dimariasimone target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=x-twitter title><span><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</span></a><a href=https://github.com/simonedimaria target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Blog><p class="text-bg font-bg">Blog</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-bg font-bg">Tags</p></a></li><li class=mt-1><a href=https://x.com/dimariasimone target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=x-twitter title><div><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></div></a></li><li class=mt-1><a href=https://github.com/simonedimaria target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=github title><div><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div></a></li><li class=mt-1><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><figure><img src=/posts/htb-businessctf-2024/metavault/background_htb_bizctf_banner_hu_25e525b9d82f27d5.png alt="HTB Business CTF 2024 - MetaVault [Author Writeup]" loading=eager decoding=async fetchpriority=high class="w-full rounded-lg single_hero_round nozoom"></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/></a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Blog</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/htb-businessctf-2024/metavault/>HTB Business CTF 2024 - MetaVault [Author Writeup]</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">HTB Business CTF 2024 - MetaVault [Author Writeup]</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-05-10T00:00:02+01:00>10 May 2024</time><span class="px-2 text-primary-500">&#183;</span><span>1765 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/categories/blockchain/","_self"),!1'><span class=flex style=cursor:pointer><span class="bg-amber-700 rounded-full border-2 border-neutral-200 px-3 py-1 text-sm font-normal text-neutral-200 dark:border-neutral-400 dark:text-neutral-200">ðŸ”— Blockchain
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/authored/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Authored
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/metadata/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Metadata
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/ipfs/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">IPFS</span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=simonedimaria src=/img/gatto-stregone-ciccione_hu_76b7b1397facf864.jpeg data-zoom-src=/img/gatto-stregone-ciccione.jpeg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">simonedimaria</div><div class="text-sm text-neutral-700 dark:text-neutral-400"><em>I make a bunch of electrons dance on some rock to hack stuff</em></div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/dimariasimone target=_blank aria-label=X-Twitter title=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/simonedimaria target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#synopsis>Synopsis</a></li><li><a href=#description>Description</a></li><li><a href=#skills-required>Skills Required</a></li><li><a href=#skills-learned>Skills Learned</a></li><li><a href=#analyzing-the-source-code>Analyzing the source code</a></li><li><a href=#hardcoded-secret->Hardcoded secret? ðŸ¤”</a></li><li><a href=#smart-contracts-metadata>Smart Contracts Metadata</a></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#bonus>Bonus</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#synopsis>Synopsis</a></li><li><a href=#description>Description</a></li><li><a href=#skills-required>Skills Required</a></li><li><a href=#skills-learned>Skills Learned</a></li><li><a href=#analyzing-the-source-code>Analyzing the source code</a></li><li><a href=#hardcoded-secret->Hardcoded secret? ðŸ¤”</a></li><li><a href=#smart-contracts-metadata>Smart Contracts Metadata</a></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#bonus>Bonus</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">MetaVault<div id=metavault class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#metavault aria-label=Anchor>#</a></span></h1><blockquote><p>10<sup>th</sup> May 2024<br>Prepared By: perrythepwner<br>Challenge Author(s): perrythepwner<br>Difficulty: <font color=green>Easy</font></p></blockquote><a id=github-resource-654cb939595460332a58fbfbfc757ea0 target=_blank href=https://github.com/simonedimaria/my-ctf-challenges/tree/main/HTB-BusinessCTF-2024/MetaVault class=cursor-pointer><div class="w-full md:w-auto pt-3 p-5 border border-neutral-200 dark:border-neutral-700 border rounded-md shadow-2xl"><div class="flex items-center"><span class="text-2xl text-neutral-800 dark:text-neutral" style=margin-right:10px><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><div id=github-resource-654cb939595460332a58fbfbfc757ea0-full_name class="m-0 font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral">simonedimaria/my-ctf-challenges</div></div><p id=github-resource-654cb939595460332a58fbfbfc757ea0-description class="m-0 mt-2 text-md text-neutral-800 dark:text-neutral">My authored CTF challenges sources and official writeups</p><div class="m-0 mt-2 flex items-center"><span class="mr-1 inline-block h-3 w-3 rounded-full" style=background-color:#0077b6></span><div class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">Solidity</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M287.9.0C297.1.0 305.5 5.25 309.5 13.52L378.1 154.8l153.3 22.7C540.4 178.8 547.8 185.1 550.7 193.7 553.5 202.4 551.2 211.9 544.8 218.2L433.6 328.4l26.3 155.5C461.4 492.9 457.7 502.1 450.2 507.4 442.8 512.7 432.1 513.4 424.9 509.1L287.9 435.9 150.1 509.1C142.9 513.4 133.1 512.7 125.6 507.4 118.2 502.1 114.5 492.9 115.1 483.9l27.1-155.5L31.11 218.2C24.65 211.9 22.36 202.4 25.2 193.7 28.03 185.1 35.5 178.8 44.49 177.5L197.7 154.8 266.3 13.52C270.4 5.249 278.7.0 287.9.0zm0 78.95L235.4 187.2C231.9 194.3 225.1 199.3 217.3 200.5L98.98 217.9 184.9 303C190.4 308.5 192.9 316.4 191.6 324.1L171.4 443.7l105.2-56.2C283.7 383.7 292.2 383.7 299.2 387.5l105.2 56.2-20.2-119.6C382.9 316.4 385.5 308.5 391 303l85.9-85.1-118.3-17.4C350.7 199.3 343.9 194.3 340.5 187.2L287.9 78.95z"/></svg></span></span><div id=github-resource-654cb939595460332a58fbfbfc757ea0-stargazers class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">1</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M80 104c13.3.0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24zm80-24c0 32.8-19.7 61-48 73.3V192c0 17.7 14.3 32 32 32H304c17.7.0 32-14.3 32-32V153.3C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V192c0 53-43 96-96 96H256v70.7c28.3 12.3 48 40.5 48 73.3.0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V288H144c-53 0-96-43-96-96V153.3C19.7 141 0 112.8.0 80 0 35.8 35.8.0 80 0s80 35.8 80 80zm208 24c13.3.0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24zM248 432c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24z"/></svg></span></span><div id=github-resource-654cb939595460332a58fbfbfc757ea0-forks class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">0</div><code class="px-2 py-1 rounded bg-neutral-200 text-neutral-800 dark:bg-neutral-800 dark:text-neutral-100 text-sm">/tree/main/HTB-BusinessCTF-2024/MetaVault</code></div></div><script>fetch("https://api.github.com/repos/simonedimaria/my-ctf-challenges",{headers:new Headers({"User-agent":"Mozilla/4.0 Custom User Agent"})}).then(e=>e.json()).then(e=>{e.full_name&&(document.getElementById("github-resource-654cb939595460332a58fbfbfc757ea0-full_name").innerHTML=e.full_name),e.description&&(document.getElementById("github-resource-654cb939595460332a58fbfbfc757ea0-description").innerHTML=e.description),e.stargazers_count!==0[0]&&(document.getElementById("github-resource-654cb939595460332a58fbfbfc757ea0-stargazers").innerHTML=e.stargazers_count),e.forks!==0[0]&&(document.getElementById("github-resource-654cb939595460332a58fbfbfc757ea0-forks").innerHTML=e.forks)}).catch(e=>console.error(e))</script></a><h2 class="relative group">Synopsis<div id=synopsis class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#synopsis aria-label=Anchor>#</a></span></h2><ul><li>Although this challenge aims to be entry level, it focuses on a quite overlooked (but at the same time important) aspect: the self verification of smart contracts and how &ldquo;secrets&rdquo; can sometimes be hidden in the metadata.</li></ul><h2 class="relative group">Description<div id=description class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#description aria-label=Anchor>#</a></span></h2><blockquote><p>The Ministry of Defense released the open source of &ldquo;MetaVault&rdquo;, the country&rsquo;s Ethereum reserves. It&rsquo;s said that they keeps secrets in a meta-location, so that no one can know them.</p></blockquote><h2 class="relative group">Skills Required<div id=skills-required class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#skills-required aria-label=Anchor>#</a></span></h2><ul><li>JSON RPC interaction.</li></ul><h2 class="relative group">Skills Learned<div id=skills-learned class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#skills-learned aria-label=Anchor>#</a></span></h2><ul><li>Smart Contract metadata.</li><li>IPFS.</li><li>Verifying Smart Contracts.</li><li>Retrieve sensitive information from compilation metadata.</li></ul><h2 class="relative group">Analyzing the source code<div id=analyzing-the-source-code class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#analyzing-the-source-code aria-label=Anchor>#</a></span></h2><p>Let&rsquo;s examine the provided source code.</p><p><strong>Setup.sol</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>25</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>{</span><span class=n>MetaVault</span><span class=p>}</span> <span class=k>from</span> <span class=s>&#34;./MetaVault.sol&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Setup</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MetaVault</span> <span class=k>public</span> <span class=k>immutable</span> <span class=n>TARGET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>()</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>TARGET</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MetaVault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>TARGET</span><span class=p>.</span><span class=n>deposit</span><span class=p>{</span><span class=nb>value</span><span class=o>:</span> <span class=mi>100</span> <span class=kc>ether</span><span class=p>}();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>isSolved</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bool</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kt>address</span><span class=p>(</span><span class=n>TARGET</span><span class=p>).</span><span class=nb>balance</span> <span class=o>==</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This setup will deploy the challenge instance for us. It appears that a <code>TARGET</code> contract will be deployed with <code>100 ethers</code> in it. To solve the challenge, we must drain the contract.</p><p><strong>Recruitment.sol</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// SPDX-License-Identifier: MoD-Internal-v1.0
</span></span></span><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>25</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * @title MetaVault
</span></span></span><span class=line><span class=cl><span class=cm> * @author Ministry of Defense
</span></span></span><span class=line><span class=cl><span class=cm> * @notice MoD (Ministry of Defense) Smart Contract storing the country&#39;s ETH reserves.
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>MetaVault</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * @notice Keccak256 hashed secret passphrase to enable emergency mode.
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev plaintext secret: [REDACTED] 
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev The secret will be stripped before open sourcing the code. Comments are not compiled anyway.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span> 
</span></span><span class=line><span class=cl>    <span class=kt>bytes32</span> <span class=k>constant</span> <span class=k>private</span> <span class=n>VAULT_SECRET_K256</span> <span class=o>=</span> <span class=mh>0x42c10591ced4987005f70d29b498348ecc8ab18dd28c5b93db931375ca826b5e</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>Deposit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=k>indexed</span> <span class=n>_from</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=k>indexed</span> <span class=n>_value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=k>indexed</span> <span class=n>_updatedBalance</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>FailedLoginAttempt</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=k>indexed</span> <span class=n>_from</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span>  <span class=k>indexed</span> <span class=n>_attempt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes32</span> <span class=k>indexed</span> <span class=n>_hashedAttempt</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>EmergencyMode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=k>indexed</span> <span class=n>_by</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>address</span> <span class=k>indexed</span> <span class=n>_fundsDestination</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev Retrieves the current ETH balance of the vault.
</span></span></span><span class=line><span class=cl><span class=cm>     * @return balance of the vault in wei.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>getVaultBalance</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint256</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>).</span><span class=nb>balance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * @notice Deposit function to receive ETH deposits.
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev emits a Deposit event with the depositor, the value deposited and the updated balance after deposit.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>deposit</span><span class=p>()</span> <span class=k>public</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>Deposit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>getVaultBalance</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>        
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * @notice Function to fire the emergency mode by selfdestructing the contract and transfering the funds away.
</span></span></span><span class=line><span class=cl><span class=cm>     * @param _secret The secret passphrase required to activate emergency mode.
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev The secret is shared only to MoD devs.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>emergency</span><span class=p>(</span><span class=kt>string</span> <span class=k>memory</span> <span class=n>_secret</span><span class=p>)</span> <span class=k>external</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>bytes32</span> <span class=n>attempt_k256</span> <span class=o>=</span> <span class=nb>keccak256</span><span class=p>(</span><span class=kt>bytes</span><span class=p>(</span><span class=n>_secret</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>attempt_k256</span> <span class=o>==</span> <span class=n>VAULT_SECRET_K256</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>emit</span> <span class=n>EmergencyMode</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nb>selfdestruct</span><span class=p>(</span><span class=k>payable</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>emit</span> <span class=n>FailedLoginAttempt</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>_secret</span><span class=p>,</span> <span class=n>attempt_k256</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We are presented with a Vault contract, developed by the &ldquo;Ministry of Defense&rdquo; which aims to securely store national Ethereum assets.<br>The contract is quite verbose due to the <a href=https://docs.soliditylang.org/en/latest/natspec-format.html target=_blank>NatSpec</a>, but essentially converges to two functionalities:</p><ol><li>The possibility of depositing funds.</li><li>Emergency mode, which can only be activated by those who know a secret passphrase, which hash Keccak256 matches the one hardcoded in the contract.</li></ol><p>We immediately understand that we will probably have to find a way to have the secret in hand to be able to <a href=https://www.alchemy.com/overviews/selfdestruct-solidity target=_blank><code>selfdestruct()</code></a> the contract.</p><h2 class="relative group">Hardcoded secret? ðŸ¤”<div id=hardcoded-secret- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#hardcoded-secret- aria-label=Anchor>#</a></span></h2><p>Looking at how the hash we need to obtain is declared, we notice how it is not possible to modify it, given that there is no storage access for that variable and it is mostly declared as <code>constant</code> and <code>private</code>.<br>However, one very curious thing catches our eye: the <a href=https://docs.soliditylang.org/en/latest/natspec-format.html target=_blank>NatSpec</a> of this state variable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * @notice Keccak256 hashed secret passphrase to enable emergency mode.
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev plaintext secret: [REDACTED] 
</span></span></span><span class=line><span class=cl><span class=cm>     * @dev The secret will be stripped before open sourcing the code. Comments are not compiled anyway.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span> 
</span></span></code></pre></div><p>What is that? Why would someone in charge of such an important task share to his developers a secret in plain text in the code??<br>The assumption was certainly made upon the fact that, the code once it gets compiled and deployed in the blockchain, comments will not be included in the bytecode; thus stating that they will only worry about removing the secret when they have to publish the source code.<br>Terrible OPSEC! What could happen if the internal code was leaked? What could happen ifâ€¦even worse, the comment was saved somewhere and published without realizing it?<br>Doubts are starting to arise, but a hint in the frontend of the platform gives us some direction.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=./assets/donttrustverify.png></figure></p><p>Said by the developers, the code was compiled with the metadata, a fairly common practice for anyone who wants to verify their smart contracts.<br>But, what really is metadata in smart contracts?</p><h2 class="relative group">Smart Contracts Metadata<div id=smart-contracts-metadata class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#smart-contracts-metadata aria-label=Anchor>#</a></span></h2><p>Based on <a href=https://docs.soliditylang.org/en/latest/metadata.html target=_blank>Solidity latest Documentation</a>, Metadata informations are nothing more than additional bytes, CBOR-encoded, append to the end of the bytecode to be easily recoverable. The compiler automatically generates these informations (unless otherwise specified) in a JSON file, which includes:</p><ul><li>Compiler Version</li><li>Compiler Settings</li><li>Contract ABI</li><li><em>Path of the compiled files</em></li><li><em><strong>NatSpec Documentation</strong></em></li></ul><p>Wait, what?<br>The path to the file on my PC? Even the NatSpec?<br>Absolutely yes! And we can immediately verify this using <a href=https://docs.soliditylang.org/en/latest/natspec-format.html target=_blank>that</a> example contract of the NatSpec documentation.<br>Rather than opening it in Remix IDE, we prefer to tinker around locally by simply using <code>solc</code>, the Solidity compiler. We go to the <code>/tmp</code> directory, use our favorite text editor to copy and paste the code and save the file as <code>MetadataTest.sol</code>. Now all we have to do is compile it, but before doing this we read from the manual that we can easily read the metadata of a contract with the <code>--metadata</code> flag. Simple as that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ solc --metadata /tmp/MetadataTest.sol
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>=======</span> MetadataTest.sol:KumquatTree <span class=o>=======</span>
</span></span><span class=line><span class=cl>Metadata:
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;compiler&#34;</span>:<span class=o>{</span><span class=s2>&#34;version&#34;</span>:<span class=s2>&#34;0.8.25+commit.b61c2a91&#34;</span><span class=o>}</span>,<span class=s2>&#34;language&#34;</span>:<span class=s2>&#34;Solidity&#34;</span>,<span class=s2>&#34;output&#34;</span>:<span class=o>{</span><span class=s2>&#34;abi&#34;</span>:<span class=o>[{</span><span class=s2>&#34;inputs&#34;</span>:<span class=o>[{</span><span class=s2>&#34;internalType&#34;</span>:<span class=s2>&#34;uint256&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;rings&#34;</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;uint256&#34;</span><span class=o>}]</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;age&#34;</span>,<span class=s2>&#34;outputs&#34;</span>:<span class=o>[{</span><span class=s2>&#34;internalType&#34;</span>:<span class=s2>&#34;uint256&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;&#34;</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;uint256&#34;</span><span class=o>}]</span>,<span class=s2>&#34;stateMutability&#34;</span>:<span class=s2>&#34;pure&#34;</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;function&#34;</span><span class=o>}</span>,<span class=o>{</span><span class=s2>&#34;inputs&#34;</span>:<span class=o>[]</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;leaves&#34;</span>,<span class=s2>&#34;outputs&#34;</span>:<span class=o>[{</span><span class=s2>&#34;internalType&#34;</span>:<span class=s2>&#34;uint256&#34;</span>,<span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;&#34;</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;uint256&#34;</span><span class=o>}]</span>,<span class=s2>&#34;stateMutability&#34;</span>:<span class=s2>&#34;pure&#34;</span>,<span class=s2>&#34;type&#34;</span>:<span class=s2>&#34;function&#34;</span><span class=o>}]</span>,<span class=s2>&#34;devdoc&#34;</span>:<span class=o>{</span><span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;dev&#34;</span>,<span class=s2>&#34;methods&#34;</span>:<span class=o>{</span><span class=s2>&#34;age(uint256)&#34;</span>:<span class=o>{</span><span class=s2>&#34;details&#34;</span>:<span class=s2>&#34;The Alexandr N. Tetearing algorithm could increase precision&#34;</span>,<span class=s2>&#34;params&#34;</span>:<span class=o>{</span><span class=s2>&#34;rings&#34;</span>:<span class=s2>&#34;The number of rings from dendrochronological sample&#34;</span><span class=o>}</span>,<span class=s2>&#34;returns&#34;</span>:<span class=o>{</span><span class=s2>&#34;_0&#34;</span>:<span class=s2>&#34;Age in years, rounded up for partial years&#34;</span><span class=o>}}</span>,<span class=s2>&#34;leaves()&#34;</span>:<span class=o>{</span><span class=s2>&#34;details&#34;</span>:<span class=s2>&#34;Returns only a fixed number.&#34;</span><span class=o>}}</span>,<span class=s2>&#34;version&#34;</span>:1<span class=o>}</span>,<span class=s2>&#34;userdoc&#34;</span>:<span class=o>{</span><span class=s2>&#34;kind&#34;</span>:<span class=s2>&#34;user&#34;</span>,<span class=s2>&#34;methods&#34;</span>:<span class=o>{</span><span class=s2>&#34;age(uint256)&#34;</span>:<span class=o>{</span><span class=s2>&#34;notice&#34;</span>:<span class=s2>&#34;Calculate tree age in years, rounded up, for live trees&#34;</span><span class=o>}</span>,<span class=s2>&#34;leaves()&#34;</span>:<span class=o>{</span><span class=s2>&#34;notice&#34;</span>:<span class=s2>&#34;Return the amount of leaves that this specific kind of tree has&#34;</span><span class=o>}}</span>,<span class=s2>&#34;version&#34;</span>:1<span class=o>}}</span>,<span class=s2>&#34;settings&#34;</span>:<span class=o>{</span><span class=s2>&#34;compilationTarget&#34;</span>:<span class=o>{</span><span class=s2>&#34;tmp/MetadataTest.sol&#34;</span>:<span class=s2>&#34;KumquatTree&#34;</span><span class=o>}</span>,<span class=s2>&#34;evmVersion&#34;</span>:<span class=s2>&#34;cancun&#34;</span>,<span class=s2>&#34;libraries&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;bytecodeHash&#34;</span>:<span class=s2>&#34;ipfs&#34;</span><span class=o>}</span>,<span class=s2>&#34;optimizer&#34;</span>:<span class=o>{</span><span class=s2>&#34;enabled&#34;</span>:false,<span class=s2>&#34;runs&#34;</span>:200<span class=o>}</span>,<span class=s2>&#34;remappings&#34;</span>:<span class=o>[]}</span>,<span class=s2>&#34;sources&#34;</span>:<span class=o>{</span><span class=s2>&#34;MetadataTest.sol&#34;</span>:<span class=o>{</span><span class=s2>&#34;keccak256&#34;</span>:<span class=s2>&#34;0x1ecb92832d772095e8f70b536826a13224d8ebd8d506556007448505faf58118&#34;</span>,<span class=s2>&#34;license&#34;</span>:<span class=s2>&#34;GPL-3.0&#34;</span>,<span class=s2>&#34;urls&#34;</span>:<span class=o>[</span><span class=s2>&#34;bzz-raw://2abff74bf1d86d205c14a6d144e04e7abf65e3e0a090ac0160815c0828300836&#34;</span>,<span class=s2>&#34;dweb:/ipfs/QmT5r1oLssy1MHKH1JBsoPSCUSe7qqvGEXumdfFLUyc39K&#34;</span><span class=o>]}}</span>,<span class=s2>&#34;version&#34;</span>:1<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>=======</span> MetadataTest.sol:Plant <span class=o>=======</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></div><p>We&rsquo;ll get a lot of info! Which isn&rsquo;t really readable, let&rsquo;s store that information in some files using the <code>--output-dir</code> flag and analyze it using <code>jq</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ solc --metadata /tmp/MetadataTest.sol --output-dir metadata
</span></span><span class=line><span class=cl>Compiler run successful. Artifact<span class=o>(</span>s<span class=o>)</span> can be found in directory <span class=s2>&#34;metadata&#34;</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> metadata/ <span class=o>&amp;&amp;</span>  ls -la
</span></span><span class=line><span class=cl>total <span class=m>20</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> May  <span class=m>9</span> 23:25 .
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>1</span> root root <span class=m>4096</span> May  <span class=m>9</span> 23:25 ..
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1461</span> May  <span class=m>9</span> 23:25 KumquatTree_meta.json
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root  <span class=m>812</span> May  <span class=m>9</span> 23:25 Plant_meta.json
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1701</span> May  <span class=m>9</span> 23:25 Tree_meta.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat Tree_meta.json <span class=p>|</span> jq   <span class=c1># let&#39;s read that for example</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;compiler&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;version&#34;</span>: <span class=s2>&#34;0.8.25+commit.b61c2a91&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;language&#34;</span>: <span class=s2>&#34;Solidity&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;output&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;abi&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;devdoc&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;author&#34;</span>: <span class=s2>&#34;Larry A. Gardner&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;custom:experimental&#34;</span>: <span class=s2>&#34;This is an experimental contract.&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;details&#34;</span>: <span class=s2>&#34;All function calls are currently implemented without side effects&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;settings&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;compilationTarget&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;tmp/MetadataTest.sol&#34;</span>: <span class=s2>&#34;Tree&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;sources&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tmp/MetadataTest.sol&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;keccak256&#34;</span>: <span class=s2>&#34;0x1ecb92832d772095e8f70b536826a13224d8ebd8d506556007448505faf58118&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;license&#34;</span>: <span class=s2>&#34;GPL-3.0&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;urls&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;bzz-raw://2abff74bf1d86d205c14a6d144e04e7abf65e3e0a090ac0160815c0828300836&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dweb:/ipfs/QmT5r1oLssy1MHKH1JBsoPSCUSe7qqvGEXumdfFLUyc39K&#34;</span>
</span></span><span class=line><span class=cl>      <span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;version&#34;</span>: <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Wow! It&rsquo;s really like that. Notice the <code>tmp/MetadataTest.sol</code> field under <code>"sources"</code>, which could potentially leak sensitive information about our system to the public.<br>Also, note the appending urls. That are the IPFS hashes of the source code, which is useful to verify that our local code matches the one deployed on the blockchain.<br>To be clearer, the flow of verifying a smart contract source code will be the following:</p><p>&ndash;> Get the bytecode (always avaiable)<br>&ndash;> Get the contract metadata (most likely it&rsquo;ll be there)<br>&ndash;> CBOR decode, get the keccak256 hash and verify the match with the local files&mldr;<br>OR<br>&ndash;> CBOR decode, get the IPFS hash of the <em>JSON metadata file</em><br>&ndash;> Hopefully it&rsquo;s pinned on IPFS, get the IPFS hash of the <em>contract source code</em><br>&ndash;> Verify match.</p><blockquote><p>Further readings:</p><ul><li><a href=https://docs.sourcify.dev/blog/verify-contracts-perfectly/ target=_blank>https://docs.sourcify.dev/blog/verify-contracts-perfectly/</a></li><li><a href=https://www.rareskills.io/post/solidity-metadata target=_blank>https://www.rareskills.io/post/solidity-metadata</a></li></ul></blockquote><p>But let&rsquo;s get back on track! Did you also noticed something event more interesting for us?<br>Yeah, the NatSpec! What if they compiled the source code (and therefore generated metadata) before stripping the secret and accidentally leaking it here?<br>That&rsquo;s possible. That&rsquo;s what they said.</p><blockquote><p>@dev The secret will be stripped before open sourcing the code. [&mldr;]</p></blockquote><p>Before open sourcing the code, meaning that they compiled it with the secret!</p><blockquote><p>[&mldr;] Comments are not compiled anyway.</p></blockquote><p>You fool. Wrong assumption.</p><p>So, our goal now is to retrieve the bytecode, then the IPFS hash, check the avaiability on a IPFS gateway and finally read the leaked secret in the NatSpec.</p><h2 class="relative group">Exploitation<div id=exploitation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#exploitation aria-label=Anchor>#</a></span></h2><p>Upon launching the challenge, we will encounter two sockets. One socket serves as the challenge handler, while the other serves as the RPC endpoint. Upon connecting to the challenge handler, we will be presented with three options:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ nc 0.0.0.0 <span class=m>1338</span>
</span></span><span class=line><span class=cl><span class=m>1</span> - Connection information
</span></span><span class=line><span class=cl><span class=m>2</span> - Restart Instance
</span></span><span class=line><span class=cl><span class=m>3</span> - Get flag
</span></span><span class=line><span class=cl>action?
</span></span></code></pre></div><p>Before proceeding, it&rsquo;s essential to launch the game instance, which will provide us with the necessary information to establish a connection.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ nc 0.0.0.0 <span class=m>1338</span>
</span></span><span class=line><span class=cl><span class=m>1</span> - Connection information
</span></span><span class=line><span class=cl><span class=m>2</span> - Restart Instance
</span></span><span class=line><span class=cl><span class=m>3</span> - Get flag
</span></span><span class=line><span class=cl>action? <span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Private key     :  0x1e7ed27cf8804c820d69d04b69745634b54a989112752dd4ddd540e4dd6c1bc5
</span></span><span class=line><span class=cl>Address         :  0x18Bdd72777BccB5bCb5590bE6c947B68B38066c6
</span></span><span class=line><span class=cl>Target contract :  0x406607888e97f1f4F1cb225fC002DF46b50a85D0
</span></span><span class=line><span class=cl>Setup contract  :  0xC8333ab86099e2cDe792F81C4BA830CCb17D9B68
</span></span></code></pre></div><p>That&rsquo;s fundamental for our first step, that is to recover the bytecode of the deployed code.<br>To do so, we can use <a href=https://book.getfoundry.sh/cast/ target=_blank><code>cast</code></a> tool to read the raw deployment transaction, or even better, use the <code>cast code</code> subcommand to get the runtime bytecode.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cast code <span class=nv>$TARGET</span> --rpc-url <span class=nv>$RPC</span>
</span></span><span class=line><span class=cl>0x60806040...snip...0033
</span></span></code></pre></div><p>Easy. Now we need to decode the metadata. In order to do so, a lot of tools comes handy, but maybe the easier one is the <a href=https://playground.sourcify.dev/ target=_blank>Sourcify Playground</a> which is also mentioned in the Solidity documentation.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=./assets/sourcify.png></figure></p><p>Here&rsquo;s our IPFS hash! Sourcify can&rsquo;t already fetch the IPFS gateway for us, because the <code>ipfs.io</code> domain isn&rsquo;t avaible anymore&mldr; that comes a challenge to the player.</p><p>At this point, we can really use any IPFS gateway. A list of live functioning gateways can be found here: <a href=https://ipfs.github.io/public-gateway-checker/ target=_blank>https://ipfs.github.io/public-gateway-checker/</a></p><p>Example with Pinata gateway:</p><p><strong>UI</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=./assets/pinataipfs.png></figure></p><p><strong>CLI</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ curl https://gateway.pinata.cloud/ipfs/QmX9L9Q9QkM3ytQ1Wk3jKAqNDXYhK8RFQHcfq8QXyfffkN <span class=p>|</span> jq
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;stateVariables&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;VAULT_SECRET_K256&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;details&#34;</span>: <span class=s2>&#34;plaintext secret: WeLoveNukaCola!!MoD-2024 The secret will be stripped before open sourcing the code. Comments are not compiled anyway.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></div><p>Here&rsquo;s the secret :)</p><pre tabindex=0><code>WeLoveNukaCola!!MoD-2024
</code></pre><p>Also, note the leaked path:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=./assets/leakedpath.png></figure></p><p>All we have to do now is DESTROY the vault. That&rsquo;s why demolition skills were required in the onboarding challenge ;)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cast send <span class=nv>$TARGET</span> <span class=s1>&#39;emergency(string)&#39;</span> <span class=s1>&#39;WeLoveNukaCola!!MoD-2024&#39;</span> --rpc-url <span class=nv>$RPC</span> --private-key <span class=nv>$PVK</span>
</span></span></code></pre></div><h3 class="relative group">Bonus<div id=bonus class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#bonus aria-label=Anchor>#</a></span></h3><p>If you&rsquo;ll lucky enough, you&rsquo;ll be able to solve the challenge only by using the following UI <a href=https://solc-metadata.ardis.lu/ target=_blank>https://solc-metadata.ardis.lu/</a> !
Which partially explains the &ldquo;Easy&rdquo; tag in this challenge.</p><hr><blockquote><p>HTB{wh0_tf_sh4r3s_s3cr3ts_1n_th3_c0mm3nts}</p></blockquote></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/HTB-BusinessCTF-2024/MetaVault/index.md data-oid-likes=likes_posts/HTB-BusinessCTF-2024/MetaVault/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/htb-businessctf-2024/notademocraticelection/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;HTB Business CTF 2024 - NotADemocraticElection [Author Writeup]
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-05-10T00:00:01+01:00>10 May 2024</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/htb-businessctf-2024/brokenswap/><span class=leading-6>HTB Business CTF 2024 - Brokenswap [Author Writeup]&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-05-10T00:00:03+01:00>10 May 2024</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
simonedimaria</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://simonedimaria.xyz/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>